[
    {
        "id": "c7015bd55ac9c57d",
        "type": "tab",
        "label": "Communication",
        "disabled": false,
        "info": "Various communication with devices",
        "env": []
    },
    {
        "id": "d974087eb4410441",
        "type": "tab",
        "label": "DB",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "9c23ead5f4cd17b6",
        "type": "tab",
        "label": "Dashboard",
        "disabled": false,
        "info": "For displaying various info",
        "env": []
    },
    {
        "id": "1292ba0fe2f33fc4",
        "type": "subflow",
        "name": "Subflow 1",
        "info": "",
        "category": "",
        "in": [],
        "out": [],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "dff9176621056133",
        "type": "group",
        "z": "c7015bd55ac9c57d",
        "name": "remote_control_car",
        "style": {
            "label": true
        },
        "nodes": [
            "e4f62c1015b6a187",
            "e5c5cf0d6bb917c5",
            "8955a8be5e602442",
            "308f248214133e70"
        ],
        "x": 74,
        "y": 39,
        "w": 612,
        "h": 202
    },
    {
        "id": "0591b57e8f20d00d",
        "type": "group",
        "z": "9c23ead5f4cd17b6",
        "name": "Styling",
        "style": {
            "label": true,
            "stroke": "#a4a4a4"
        },
        "nodes": [
            "dc1d7aadb5cf6f36",
            "b23d2583cd712fdc"
        ],
        "x": 54,
        "y": 19,
        "w": 412,
        "h": 82
    },
    {
        "id": "c9965334e0b36a0b",
        "type": "group",
        "z": "d974087eb4410441",
        "name": "Car",
        "style": {
            "label": true
        },
        "nodes": [
            "1236e3bf163b4142",
            "eb6d2cad886648e8",
            "e893b7685905402d",
            "6f161c9edf33ba3d",
            "fbb060fd70043410",
            "8f11c965debd450e"
        ],
        "x": 64,
        "y": 1819,
        "w": 312,
        "h": 202
    },
    {
        "id": "30665a9e1110e356",
        "type": "group",
        "z": "c7015bd55ac9c57d",
        "name": "Test",
        "style": {
            "label": true
        },
        "nodes": [
            "0dd2fd9545bda4ca",
            "0817f2202b3f46a9",
            "4485a75d1a0f656c",
            "f7f0e15a2aa36350",
            "7caeb28ac2a0cba9",
            "32d91f45c0238651",
            "d56752421e229ef8",
            "1d9c3b808be68e07",
            "d64de82239fb1bbd",
            "9089e3c94b2ce382",
            "0c4411c448ac4caa",
            "899bd7a9f2ce31ab"
        ],
        "x": 74,
        "y": 2939,
        "w": 642,
        "h": 482
    },
    {
        "id": "113b862a748abc98",
        "type": "group",
        "z": "c7015bd55ac9c57d",
        "name": "Car",
        "style": {
            "label": true
        },
        "nodes": [
            "f118c9cde3adfa79",
            "6abf56e4a87d6a49",
            "a2d3c7c1ccc6f567",
            "038b288f4ba869de",
            "2f4b2f43ca14af61",
            "b27aeb6f7cd37378"
        ],
        "x": 74,
        "y": 339,
        "w": 292,
        "h": 202
    },
    {
        "id": "9e784f1479b1ecc4",
        "type": "group",
        "z": "c7015bd55ac9c57d",
        "name": "toll_station",
        "style": {
            "label": true
        },
        "nodes": [
            "21275fd3a4c7913e",
            "5454094dd1d0958e",
            "c7906ff188775303",
            "0e2e50fab3fb368c"
        ],
        "x": 68,
        "y": 613,
        "w": 1174,
        "h": 1054
    },
    {
        "id": "1343424fbbdc4b4e",
        "type": "group",
        "z": "9c23ead5f4cd17b6",
        "name": "users_overview_page",
        "style": {
            "label": true
        },
        "nodes": [
            "ea5ff2cd0cdfe128",
            "723dda3faa263f6c",
            "070400a13d344993",
            "856de6d3ce3eff89",
            "f088635e3f42d421",
            "33998569dd15990e",
            "efe612ce80eab15c"
        ],
        "x": 54,
        "y": 119,
        "w": 632,
        "h": 162
    },
    {
        "id": "8d23dc769da0d07f",
        "type": "group",
        "z": "d974087eb4410441",
        "name": "users_handler",
        "style": {
            "label": true
        },
        "nodes": [
            "77ef07ddbc346c22",
            "22308172980d6de6",
            "a5837349ffd6fca1",
            "2bd950a05a93757a"
        ],
        "x": 94,
        "y": 39,
        "w": 482,
        "h": 82
    },
    {
        "id": "0829e4ce132f4920",
        "type": "group",
        "z": "9c23ead5f4cd17b6",
        "name": "toll_prices_edit",
        "style": {
            "label": true
        },
        "nodes": [
            "116ddb3989f7865c",
            "69f933624170a8db",
            "1d2d15338a8c5623",
            "074b02fb1e104e89"
        ],
        "x": 48,
        "y": 313,
        "w": 1144,
        "h": 934
    },
    {
        "id": "025c3a8da95b8f7a",
        "type": "group",
        "z": "d974087eb4410441",
        "name": "charge_station",
        "style": {
            "label": true
        },
        "nodes": [
            "9939226cfed744ae",
            "f869eda640303ea9",
            "06136996c1318fcb"
        ],
        "x": 78,
        "y": 1133,
        "w": 1134,
        "h": 614
    },
    {
        "id": "716618853d781b35",
        "type": "group",
        "z": "9c23ead5f4cd17b6",
        "name": "charge_station_ui",
        "style": {
            "label": true
        },
        "nodes": [
            "d02bfa02ad7249ef",
            "4f73999c3ec0b730",
            "02ae78a50512873e",
            "851722563ece208c",
            "8c702c77dd36bdca",
            "a2f162b9d394a186",
            "5763ca455449785b",
            "534a1b47f4d8f647",
            "98166c48d39ce2bd",
            "5c642316acf14a1a",
            "df1a6337d2b7930f",
            "28982104b2fdba96",
            "3e228f6c26bdbf05"
        ],
        "x": 54,
        "y": 1319,
        "w": 612,
        "h": 562
    },
    {
        "id": "8ceaad14f6929143",
        "type": "group",
        "z": "d974087eb4410441",
        "name": "db tollstation",
        "style": {
            "label": true
        },
        "nodes": [
            "fa423b6c44026824",
            "7c5378ce3d8e1fab",
            "1060263491f37862",
            "24a0ae6f8db3a12a",
            "8a632c5013bf1898"
        ],
        "x": 88,
        "y": 153,
        "w": 1154,
        "h": 894
    },
    {
        "id": "6a95e8aa54c858ac",
        "type": "group",
        "z": "c7015bd55ac9c57d",
        "name": "charge_station",
        "style": {
            "label": true
        },
        "nodes": [
            "f584a4b68256cfb5",
            "4ecb82d421e1e537",
            "5a8e251b3584b916",
            "6f5a50d2464f8b9d",
            "83455dfa39324952",
            "6867b32ed421a65b",
            "fe453aeef45b1417",
            "51a9f59e2ff22e1d",
            "294141438e9d3d04",
            "7c5fc2a9159033fa",
            "4a243c07d4bb3d89",
            "238096ea929842a9",
            "3e6aaa8a256b8c8f",
            "fcc679d18dbe9066",
            "23f5fdbd7fa84225",
            "3da3db495b46e423",
            "23b4e448863048a3",
            "02b7c48b5e854a1a",
            "9c13ce0ea3ea12b4",
            "251a0a65d7069398",
            "bd1541638d4772dc",
            "a7ef2574578de56d",
            "92aca90c4405a617",
            "f0a06994da576122",
            "ed2ad7e7d6998b33",
            "259641d5ce583eb5",
            "b68accdce12ce7eb",
            "1bfb51ebb430b759",
            "8909798ad584083f",
            "678ef6e30af00481",
            "9715f242360c1c97",
            "60256e9b498b8dd5",
            "48a4a3c3dd98820c",
            "d37374ec32398ba1",
            "89b42281cdae4137",
            "1e6243a71c3975d4",
            "20e026677c68bd7b",
            "39399d0e48774684",
            "8ea8dd53a495a2bf",
            "e029ce6434ae6809",
            "aef2d89cedb36727",
            "2c8d18f302ac3197",
            "fd8b447bf519396b",
            "e80bf7ba3e2dd6c3",
            "5cda82b0547e3d5f",
            "3356be1c031e3e84"
        ],
        "x": 74,
        "y": 1839,
        "w": 1652,
        "h": 1062
    },
    {
        "id": "9939226cfed744ae",
        "type": "group",
        "z": "d974087eb4410441",
        "g": "025c3a8da95b8f7a",
        "name": "initiate_charging",
        "style": {
            "label": true
        },
        "nodes": [
            "681cc84e5c74f62f",
            "4d138347c7b68093",
            "48b7e43ac0572c19",
            "0b961f7bd67c5a6d",
            "339c8a7199811e95",
            "5adf0c52630de6c2",
            "1c1f1601857b064c",
            "36f3a52d4639e8b9",
            "a86da9f0852228de",
            "d87ad496b027c132"
        ],
        "x": 104,
        "y": 1159,
        "w": 1082,
        "h": 162
    },
    {
        "id": "21275fd3a4c7913e",
        "type": "group",
        "z": "c7015bd55ac9c57d",
        "g": "9e784f1479b1ecc4",
        "name": "return_toll_price",
        "style": {
            "label": true
        },
        "nodes": [
            "56faac02af1e3921",
            "892664ccd686b134",
            "a8858f8a4c84de28",
            "3eb8a7513cd893f0",
            "6d866f700464c477"
        ],
        "x": 104,
        "y": 1499,
        "w": 592,
        "h": 142
    },
    {
        "id": "5454094dd1d0958e",
        "type": "group",
        "z": "c7015bd55ac9c57d",
        "g": "9e784f1479b1ecc4",
        "name": "get_power_prices",
        "style": {
            "label": true
        },
        "nodes": [
            "b4fe374a9bd7e327",
            "1924828f1dadb641",
            "0c28e72814e9bbae",
            "270c46f9ca7fe345",
            "75db24836ef699f2",
            "7047c6b94e2edca3",
            "11e643123ec5b919",
            "5447f1d107d07b4d",
            "216a5b5f33c20201",
            "6583d5f44e957ce0",
            "93a705171c063e17",
            "a6ad1c1bf0c2f9b0",
            "249134f2a57f31e6"
        ],
        "x": 94,
        "y": 639,
        "w": 1122,
        "h": 242
    },
    {
        "id": "116ddb3989f7865c",
        "type": "group",
        "z": "9c23ead5f4cd17b6",
        "g": "0829e4ce132f4920",
        "name": "set_toll_prices",
        "style": {
            "label": true
        },
        "nodes": [
            "728bcfee316180c5",
            "9695c47a09c4d657",
            "fd21801d95c179a1",
            "6a8d7251a99d269b",
            "49ab5c9eef18e2fe",
            "d3bb702bcdf691a1",
            "2636e9073bae688d",
            "d5bb29401cd9c2f9",
            "d2c115aaae325b40",
            "ddefcb191dc9d43a"
        ],
        "x": 74,
        "y": 679,
        "w": 1072,
        "h": 202
    },
    {
        "id": "69f933624170a8db",
        "type": "group",
        "z": "9c23ead5f4cd17b6",
        "g": "0829e4ce132f4920",
        "name": "refresh_toll_prices_page",
        "style": {
            "label": true
        },
        "nodes": [
            "04613cd67e7bd8bd",
            "d9f5b4ebe6ceadec",
            "6f2b6412d3243be9",
            "32bba6d6bdb66cee",
            "7d834a69f9cfe8eb",
            "da204c00005594c9",
            "38573d34b841eb61",
            "9ae509c0229a4605",
            "9dca2e760e12e3df",
            "ef9316e3662e77af",
            "b3df72d8dcb2bc3a",
            "2d68d6a1aa9ef244",
            "2848dc9c2586b927",
            "438180f8e7ed266d",
            "f66c10cd59cbac6e",
            "0ef456bd120be2eb",
            "1d92a8088d77f436"
        ],
        "x": 94,
        "y": 339,
        "w": 1072,
        "h": 282
    },
    {
        "id": "f869eda640303ea9",
        "type": "group",
        "z": "d974087eb4410441",
        "g": "025c3a8da95b8f7a",
        "name": "finish_charging",
        "style": {
            "label": true
        },
        "nodes": [
            "684afc80e9bd7aa7",
            "f33f70cd07956bd8",
            "f8490ccc66c6627f",
            "8c7190358fbefe98",
            "e1ddf0cb76206c25",
            "e4955c44e4805be0",
            "4a53b9a4fd55590d",
            "a496dfbf1a877790",
            "795507a12a4eb874",
            "59b278d15e2d929b",
            "be19f84d4420d31b",
            "74c045ed69fa92a5"
        ],
        "x": 104,
        "y": 1359,
        "w": 1082,
        "h": 242
    },
    {
        "id": "c7906ff188775303",
        "type": "group",
        "z": "c7015bd55ac9c57d",
        "g": "9e784f1479b1ecc4",
        "name": "return_power_price",
        "style": {
            "label": true
        },
        "nodes": [
            "ed9b01e046d144e7",
            "c299a20498ef6157",
            "c5625aae3982120b",
            "50b307eb95867622",
            "660a1d8987b9b7bb",
            "83478248c9afeea4",
            "f9013a522c1abdd8",
            "50366ad6532503c4",
            "c6e4d7cfcfad47e1",
            "b4907d24f57876bb",
            "c6b56c5e4cf401b5",
            "53730560459116ec",
            "1c71198eb632d947",
            "957a6922777db625",
            "46acc0101d9a3012"
        ],
        "x": 94,
        "y": 919,
        "w": 1042,
        "h": 342
    },
    {
        "id": "fa423b6c44026824",
        "type": "group",
        "z": "d974087eb4410441",
        "g": "8ceaad14f6929143",
        "name": "insert_powerprice",
        "style": {
            "label": true
        },
        "nodes": [
            "b3c8efd25d693eb7",
            "2fa7fa16.df7d36",
            "8c41d7d6d675747c",
            "6deff2c3917ab08e",
            "20fc10f82e1fbb3c",
            "f5f52c154dc1c527",
            "465b90c9e7577fdd",
            "b8b5793024a68019",
            "bd2be327c3068176",
            "6c75f5e6b0bae9ef",
            "fef5e4ca78ea74f7"
        ],
        "x": 124,
        "y": 179,
        "w": 1092,
        "h": 202
    },
    {
        "id": "7c5378ce3d8e1fab",
        "type": "group",
        "z": "d974087eb4410441",
        "g": "8ceaad14f6929143",
        "name": "get_userscore_and_price",
        "style": {
            "label": true
        },
        "nodes": [
            "f1c8edc3f112fcf2",
            "06dc7761e9b36e06",
            "8a79294f8c9e1bda",
            "2492751851d4ab57",
            "6578372151a0df87",
            "bd683dfaf575d92b",
            "8ff91e6586ddbeb6",
            "70ea88b87505faaa",
            "2311204e8aeb792a"
        ],
        "x": 124,
        "y": 399,
        "w": 1082,
        "h": 142
    },
    {
        "id": "1060263491f37862",
        "type": "group",
        "z": "d974087eb4410441",
        "g": "8ceaad14f6929143",
        "name": "get_most_recent_toll_prices",
        "style": {
            "label": true
        },
        "nodes": [
            "f6d3906734b58c4b",
            "2d95327a837381a2",
            "e8c5ccf60952c2be",
            "0f60eb9b92962992",
            "a501c4b70711fc78",
            "e1c49e9771213b10",
            "f82bd2713bd5bea4"
        ],
        "x": 114,
        "y": 559,
        "w": 1092,
        "h": 142
    },
    {
        "id": "1d2d15338a8c5623",
        "type": "group",
        "z": "9c23ead5f4cd17b6",
        "g": "0829e4ce132f4920",
        "name": "display_transactions",
        "style": {
            "label": true
        },
        "nodes": [
            "5d464c9e479cc761",
            "13ca023302f0f7c1",
            "972d5d3d6cd4f34a"
        ],
        "x": 84,
        "y": 1079,
        "w": 582,
        "h": 142
    },
    {
        "id": "24a0ae6f8db3a12a",
        "type": "group",
        "z": "d974087eb4410441",
        "g": "8ceaad14f6929143",
        "name": "display_transactions",
        "style": {
            "label": true
        },
        "nodes": [
            "ebb5eb51d6d86baa",
            "d5b6cd3abd938e5d",
            "0a9dc2d0d62b6741",
            "753dc434ae2fe719",
            "fff91732d0fa8eaa"
        ],
        "x": 114,
        "y": 899,
        "w": 872,
        "h": 122
    },
    {
        "id": "0e2e50fab3fb368c",
        "type": "group",
        "z": "c7015bd55ac9c57d",
        "g": "9e784f1479b1ecc4",
        "name": "request_insert_transactions",
        "style": {
            "label": true
        },
        "nodes": [
            "6e8bd7cd38c95929",
            "3930943413a6acb5",
            "0ff79d5862a3a192",
            "54eb79583afd2a77",
            "2fdb2fe082259b37",
            "9125513fcaa2699c",
            "9de20b94d51e8a81",
            "4c286d0a4cbe55d2"
        ],
        "x": 104,
        "y": 1299,
        "w": 822,
        "h": 182
    },
    {
        "id": "8a632c5013bf1898",
        "type": "group",
        "z": "d974087eb4410441",
        "g": "8ceaad14f6929143",
        "name": "",
        "style": {
            "label": true
        },
        "nodes": [
            "be6997b1779be1cb",
            "7d512223b414436e",
            "f703b09e8d73837c",
            "dcdd044879c73676",
            "3da54f0627ca6745",
            "499684e2335af520",
            "f8943814e6c6be7b",
            "32aa47b877961343",
            "e3c1bd84176d0d68",
            "57b455cfb704e63e"
        ],
        "x": 114,
        "y": 719,
        "w": 1082,
        "h": 162
    },
    {
        "id": "06136996c1318fcb",
        "type": "group",
        "z": "d974087eb4410441",
        "g": "025c3a8da95b8f7a",
        "name": "show_charge_records",
        "style": {
            "label": true
        },
        "nodes": [
            "1eb5338ba054f538",
            "f389868ad80b10d3",
            "f676c8b0e33e3933",
            "94a3aa3a2d9fab70"
        ],
        "x": 104,
        "y": 1639,
        "w": 632,
        "h": 82
    },
    {
        "id": "074b02fb1e104e89",
        "type": "group",
        "z": "9c23ead5f4cd17b6",
        "g": "0829e4ce132f4920",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "caea40b5a9e7fce1",
            "c7142d427ef14ae9",
            "2aef9186218d7693",
            "84adb6cc5526036c"
        ],
        "x": 84,
        "y": 919,
        "w": 642,
        "h": 122
    },
    {
        "id": "f2952bbb2ad433e2",
        "type": "MySQLdatabase",
        "name": "TestDB",
        "host": "${DB_HOST}",
        "port": "${DB_PORT}",
        "db": "testdb",
        "tz": "",
        "charset": "UTF8"
    },
    {
        "id": "dc20097875203fb9",
        "type": "mqtt-broker",
        "name": "docker-mqtt",
        "broker": "mqtt",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "ed3a4854fa1b4db8",
        "type": "ui-base",
        "name": "Dashboard",
        "path": "/dashboard",
        "includeClientData": true,
        "acceptsClientConfig": [
            "ui-notification",
            "ui-control"
        ],
        "showPathInSidebar": false,
        "navigationStyle": "default"
    },
    {
        "id": "91be7011842be941",
        "type": "ui-theme",
        "name": "Default Theme",
        "colors": {
            "surface": "#ffffff",
            "primary": "#5c8192",
            "bgPage": "#eeeeee",
            "groupBg": "#ffffff",
            "groupOutline": "#cccccc"
        },
        "sizes": {
            "pagePadding": "12px",
            "groupGap": "12px",
            "groupBorderRadius": "4px",
            "widgetGap": "12px"
        }
    },
    {
        "id": "a20dc435c727eb9b",
        "type": "ui-page",
        "name": "Home",
        "ui": "ed3a4854fa1b4db8",
        "path": "/home",
        "icon": "home",
        "layout": "notebook",
        "theme": "91be7011842be941",
        "order": 1,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "78b509623ddc3923",
        "type": "ui-group",
        "name": "Control",
        "page": "a20dc435c727eb9b",
        "width": "6",
        "height": "1",
        "order": -1,
        "showTitle": true,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "4880197e99519344",
        "type": "ui-page",
        "name": "Contact",
        "ui": "ed3a4854fa1b4db8",
        "path": "/contact",
        "icon": "information",
        "layout": "notebook",
        "theme": "91be7011842be941",
        "order": 5,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "d68e6862685d10df",
        "type": "ui-group",
        "name": "Ratings",
        "page": "4880197e99519344",
        "width": "6",
        "height": "1",
        "order": -1,
        "showTitle": true,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "a29bbf123578a015",
        "type": "ui-page",
        "name": "Users",
        "ui": "ed3a4854fa1b4db8",
        "path": "/users",
        "icon": "table-account",
        "layout": "notebook",
        "theme": "91be7011842be941",
        "order": 4,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "8e8e755dd05b63ae",
        "type": "ui-page",
        "name": "Toll station",
        "ui": "ed3a4854fa1b4db8",
        "path": "/tollstation",
        "icon": "view-dashboard",
        "layout": "notebook",
        "theme": "91be7011842be941",
        "order": 3,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "e6a3eaaef97c58a0",
        "type": "ui-group",
        "name": "All users",
        "page": "a29bbf123578a015",
        "width": "6",
        "height": "1",
        "order": -1,
        "showTitle": true,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "f4b408f314ea8fb3",
        "type": "ui-group",
        "name": "Toll Prices",
        "page": "8e8e755dd05b63ae",
        "width": "6",
        "height": "1",
        "order": 2,
        "showTitle": true,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "2236dfd1.c909e",
        "type": "MySQLdatabase",
        "name": "",
        "host": "127.0.0.1",
        "port": "3306",
        "db": "test",
        "tz": "",
        "charset": ""
    },
    {
        "id": "ceb1dfd5478da751",
        "type": "ui-page",
        "name": "Charge station",
        "ui": "ed3a4854fa1b4db8",
        "path": "/chargestation",
        "icon": "ev-station",
        "layout": "notebook",
        "theme": "91be7011842be941",
        "order": 2,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "6294bb50f136aac5",
        "type": "ui-group",
        "name": "Charging  Information",
        "page": "ceb1dfd5478da751",
        "width": "6",
        "height": "1",
        "order": -1,
        "showTitle": true,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "b2e2400c7d47390e",
        "type": "ui-group",
        "name": "Transactions",
        "page": "8e8e755dd05b63ae",
        "width": "6",
        "height": "1",
        "order": 3,
        "showTitle": true,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "31182dd191e0795c",
        "type": "ui-group",
        "name": "charge_transaction_overview",
        "page": "ceb1dfd5478da751",
        "width": "6",
        "height": "1",
        "order": -1,
        "showTitle": true,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "d6abd85606225eb0",
        "type": "ui-group",
        "name": "Status",
        "page": "8e8e755dd05b63ae",
        "width": "6",
        "height": "1",
        "order": 1,
        "showTitle": true,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "e4f62c1015b6a187",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "dff9176621056133",
        "name": "debug 15",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 200,
        "wires": []
    },
    {
        "id": "e5c5cf0d6bb917c5",
        "type": "mqtt out",
        "z": "c7015bd55ac9c57d",
        "g": "dff9176621056133",
        "name": "control",
        "topic": "car/control",
        "qos": "0",
        "retain": "true",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "dc20097875203fb9",
        "x": 570,
        "y": 140,
        "wires": []
    },
    {
        "id": "5631cd8e37f10e5f",
        "type": "inject",
        "z": "c7015bd55ac9c57d",
        "name": "insert_user",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "insert",
        "payload": "{\"d_score\":194}",
        "payloadType": "json",
        "x": 840,
        "y": 80,
        "wires": [
            [
                "6eb947dff35c7a58"
            ]
        ]
    },
    {
        "id": "6eb947dff35c7a58",
        "type": "json",
        "z": "c7015bd55ac9c57d",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": true,
        "x": 1070,
        "y": 80,
        "wires": [
            [
                "414f9ce98347a63b"
            ]
        ]
    },
    {
        "id": "414f9ce98347a63b",
        "type": "link out",
        "z": "c7015bd55ac9c57d",
        "name": "link out 2",
        "mode": "link",
        "links": [
            "34ea1d322de1ddc2"
        ],
        "x": 1275,
        "y": 80,
        "wires": []
    },
    {
        "id": "8955a8be5e602442",
        "type": "ui-text",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "dff9176621056133",
        "group": "78b509623ddc3923",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "show_input",
        "label": "Output",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "className": "{{msg.payload}}",
        "x": 590,
        "y": 80,
        "wires": []
    },
    {
        "id": "f118c9cde3adfa79",
        "type": "mqtt in",
        "z": "c7015bd55ac9c57d",
        "g": "113b862a748abc98",
        "name": "",
        "topic": "car/distance",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "dc20097875203fb9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 170,
        "y": 380,
        "wires": [
            [
                "038b288f4ba869de"
            ]
        ]
    },
    {
        "id": "6abf56e4a87d6a49",
        "type": "mqtt in",
        "z": "c7015bd55ac9c57d",
        "g": "113b862a748abc98",
        "name": "",
        "topic": "car/speed",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "dc20097875203fb9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 440,
        "wires": [
            [
                "2f4b2f43ca14af61"
            ]
        ]
    },
    {
        "id": "a2d3c7c1ccc6f567",
        "type": "mqtt in",
        "z": "c7015bd55ac9c57d",
        "g": "113b862a748abc98",
        "name": "",
        "topic": "car/score",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "dc20097875203fb9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 500,
        "wires": [
            [
                "b27aeb6f7cd37378"
            ]
        ]
    },
    {
        "id": "038b288f4ba869de",
        "type": "link out",
        "z": "c7015bd55ac9c57d",
        "g": "113b862a748abc98",
        "name": "distance",
        "mode": "link",
        "links": [
            "1236e3bf163b4142"
        ],
        "x": 325,
        "y": 380,
        "wires": []
    },
    {
        "id": "2f4b2f43ca14af61",
        "type": "link out",
        "z": "c7015bd55ac9c57d",
        "g": "113b862a748abc98",
        "name": "speed",
        "mode": "link",
        "links": [
            "eb6d2cad886648e8"
        ],
        "x": 325,
        "y": 440,
        "wires": []
    },
    {
        "id": "b27aeb6f7cd37378",
        "type": "link out",
        "z": "c7015bd55ac9c57d",
        "g": "113b862a748abc98",
        "name": "score",
        "mode": "link",
        "links": [
            "e893b7685905402d"
        ],
        "x": 325,
        "y": 500,
        "wires": []
    },
    {
        "id": "0dd2fd9545bda4ca",
        "type": "ui-template",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "30665a9e1110e356",
        "group": "d68e6862685d10df",
        "page": "",
        "ui": "",
        "name": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "head": "",
        "format": "<template>\n  <div>\n    <v-progress-linear\n      color=\"yellow-darken-2\"\n      indeterminate\n    ></v-progress-linear>\n    <br>\n    <v-progress-linear\n      color=\"green\"\n      indeterminate\n    ></v-progress-linear>\n    <br>\n    <v-progress-linear\n      color=\"teal\"\n      indeterminate\n    ></v-progress-linear>\n    <br>\n    <v-progress-linear\n      color=\"cyan\"\n      indeterminate\n    ></v-progress-linear>\n  </div>\n</template>",
        "storeOutMessages": true,
        "passthru": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 260,
        "y": 2980,
        "wires": [
            [
                "0817f2202b3f46a9"
            ]
        ]
    },
    {
        "id": "0817f2202b3f46a9",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "30665a9e1110e356",
        "name": "debug 19",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 560,
        "y": 2980,
        "wires": []
    },
    {
        "id": "4485a75d1a0f656c",
        "type": "ui-template",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "30665a9e1110e356",
        "group": "78b509623ddc3923",
        "page": "",
        "ui": "",
        "name": "displaymsg",
        "order": 0,
        "width": 0,
        "height": 0,
        "head": "",
        "format": "<template>\n    <div>\n        <h2>Latest <code>msg</code> received:</h2>\n        <pre>{{ msg }}</pre>\n    </div>\n</template>",
        "storeOutMessages": true,
        "passthru": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 410,
        "y": 3080,
        "wires": [
            [
                "f7f0e15a2aa36350"
            ]
        ]
    },
    {
        "id": "f7f0e15a2aa36350",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "30665a9e1110e356",
        "name": "debug 21",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 610,
        "y": 3100,
        "wires": []
    },
    {
        "id": "7caeb28ac2a0cba9",
        "type": "inject",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "30665a9e1110e356",
        "name": "insert_user",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "insert",
        "payload": "{\"d_score\":194}",
        "payloadType": "json",
        "x": 180,
        "y": 3140,
        "wires": [
            [
                "4485a75d1a0f656c"
            ]
        ]
    },
    {
        "id": "32d91f45c0238651",
        "type": "ui-template",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "30665a9e1110e356",
        "group": "78b509623ddc3923",
        "page": "",
        "ui": "",
        "name": "custom_event",
        "order": 0,
        "width": 0,
        "height": 0,
        "head": "",
        "format": "<template>\n\n<v-btn @click=\"$socket.emit('ui-event', 'ed2de3066e8f442a', msg)\">Send Custom Event</v-btn>\n\n</template>",
        "storeOutMessages": true,
        "passthru": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 400,
        "y": 3260,
        "wires": [
            [
                "d56752421e229ef8"
            ]
        ]
    },
    {
        "id": "d56752421e229ef8",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "30665a9e1110e356",
        "name": "debug 22",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 600,
        "y": 3200,
        "wires": []
    },
    {
        "id": "1d9c3b808be68e07",
        "type": "ui-template",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "30665a9e1110e356",
        "group": "78b509623ddc3923",
        "page": "",
        "ui": "",
        "name": "socket_listen",
        "order": 0,
        "width": 0,
        "height": 0,
        "head": "",
        "format": "<template>\n    <!-- Any HTML can go here -->\n    <button class=\"my-class2\" onclick=\"onClick()\">My Button</button>\n</template>\n\n<script>\n    /* Write any JavaScript here */\n    // add our onClick function to the window object to make it accessible by the HTML <button>\n    window.onClick = function () {\n        alert('Button has been clicked')\n    }\n\n    // Use send() function to pass on data back into Node-RED:\n    this.send('Component has loaded')\n\n    // Subscribe to the incoming msg's\n    this.$socket.on('msg-input:' + this.id, function(msg) {\n        // do stuff with the message\n        alert('message received: ' + msg.payload + 'from' + this.id)\n    })\n</script>\n\n<style>\n    /* define any styles here - supports raw CSS */\n    .my-class2 {\n        color: green;\n    }\n</style>",
        "storeOutMessages": true,
        "passthru": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 390,
        "y": 3380,
        "wires": [
            [
                "d64de82239fb1bbd"
            ]
        ]
    },
    {
        "id": "d64de82239fb1bbd",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "30665a9e1110e356",
        "name": "debug 23",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 3320,
        "wires": []
    },
    {
        "id": "9089e3c94b2ce382",
        "type": "ui-template",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "30665a9e1110e356",
        "group": "",
        "page": "4880197e99519344",
        "ui": "",
        "name": "",
        "order": 0,
        "width": 0,
        "height": 0,
        "head": "",
        "format": "<template>\n    <div>\n        <p>Query Parameter: {{ $route.query }}</p>\n    </div>\n</template>",
        "storeOutMessages": true,
        "passthru": true,
        "resendOnRefresh": true,
        "templateScope": "widget:page",
        "className": "",
        "x": 360,
        "y": 3160,
        "wires": [
            []
        ]
    },
    {
        "id": "0c4411c448ac4caa",
        "type": "inject",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "30665a9e1110e356",
        "name": "insert_user",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "insert",
        "payload": "{\"d_score\":194}",
        "payloadType": "json",
        "x": 200,
        "y": 3320,
        "wires": [
            [
                "1d9c3b808be68e07"
            ]
        ]
    },
    {
        "id": "899bd7a9f2ce31ab",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "30665a9e1110e356",
        "name": "function 3",
        "func": "msg.payload = 'hi'\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 160,
        "y": 3220,
        "wires": [
            [
                "32d91f45c0238651"
            ]
        ]
    },
    {
        "id": "b4fe374a9bd7e327",
        "type": "http request",
        "z": "c7015bd55ac9c57d",
        "g": "5454094dd1d0958e",
        "name": "get_power_prices",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.hvakosterstrommen.no/api/v1/prices/{{{topic}}}.json ",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 670,
        "y": 680,
        "wires": [
            [
                "270c46f9ca7fe345"
            ]
        ]
    },
    {
        "id": "1924828f1dadb641",
        "type": "inject",
        "z": "c7015bd55ac9c57d",
        "g": "5454094dd1d0958e",
        "name": "emulate_toll_station",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Tollstation ID: 1, Car ID: 1, Driver ID: 1",
        "payloadType": "str",
        "x": 230,
        "y": 680,
        "wires": [
            [
                "0c28e72814e9bbae"
            ]
        ]
    },
    {
        "id": "0c28e72814e9bbae",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "5454094dd1d0958e",
        "name": "get_now",
        "func": "//let date2 = new Date(Date.UTC(2012, 3, 0, 3, 0, 0)).toLocaleDateString(\"no-NO\", {day: \"2-digit\"}).slice(0,2)\nlet date = new Date();\n\nlet received_string = msg.payload;\n\nif (/Car 2 paid:/i.test(received_string)) {\n    return null;\n} else if (/Car 1 has not been let through/i.test(received_string)) {\n    return null;\n}\n\n//\"Toll ID: 1, Car ID: 3, driver ID: 3\"\n\nconst res = /Tollstation ID: ([0-9]+),Car ID: ([0-9]+),Driver ID: ([0-9]+)/;\n\nlet regex_find = received_string.match(res);\n\nflow.set(\"toll_id\", parseInt(regex_find[1], 10));\nflow.set(\"car_id\", parseInt(regex_find[2], 10));\nflow.set(\"user_id\",parseInt(regex_find[3], 10));\n\n//let day = date.getDay().toLocaleString(\"no_NO\", options);\nlet day = date.toLocaleDateString(\"no-NO\", {day: \"2-digit\"}).slice(0,2);\nlet month = date.toLocaleDateString(\"no-NO\", {month: \"2-digit\"}).slice(0,2);\nlet year = date.getFullYear();\n\nmsg.topic = `${year}/${month}-${day}_NO5`;\n\n//msg.payload = day\n//msg.topic = \"/2024/05-30_NO5\";\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 680,
        "wires": [
            [
                "93a705171c063e17",
                "b4fe374a9bd7e327",
                "a6ad1c1bf0c2f9b0"
            ]
        ]
    },
    {
        "id": "270c46f9ca7fe345",
        "type": "json",
        "z": "c7015bd55ac9c57d",
        "g": "5454094dd1d0958e",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 830,
        "y": 680,
        "wires": [
            [
                "75db24836ef699f2"
            ]
        ]
    },
    {
        "id": "75db24836ef699f2",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "5454094dd1d0958e",
        "name": "get_current_price",
        "func": "\n\nlet hour = new Date().getHours();\n\n\n\nlet prices = msg.payload;\n\nlet toll_info = {\n    price: prices[hour]['NOK_per_kWh'],\n    car_id: flow.get(\"car_id\"),\n    toll_id: flow.get(\"toll_id\")\n}\nmsg.topic = \"\"\nmsg.payload = toll_info;\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 990,
        "y": 680,
        "wires": [
            [
                "7047c6b94e2edca3",
                "11e643123ec5b919"
            ]
        ]
    },
    {
        "id": "7047c6b94e2edca3",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "5454094dd1d0958e",
        "name": "debug 30",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1100,
        "y": 780,
        "wires": []
    },
    {
        "id": "5447f1d107d07b4d",
        "type": "mqtt in",
        "z": "c7015bd55ac9c57d",
        "g": "5454094dd1d0958e",
        "name": "",
        "topic": "Toll-station",
        "qos": "1",
        "datatype": "auto-detect",
        "broker": "dc20097875203fb9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 180,
        "y": 760,
        "wires": [
            [
                "216a5b5f33c20201",
                "0c28e72814e9bbae",
                "249134f2a57f31e6"
            ]
        ]
    },
    {
        "id": "216a5b5f33c20201",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "5454094dd1d0958e",
        "name": "debug 31",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 400,
        "y": 760,
        "wires": []
    },
    {
        "id": "56faac02af1e3921",
        "type": "link in",
        "z": "c7015bd55ac9c57d",
        "g": "21275fd3a4c7913e",
        "name": "comms.input.return_to_toll",
        "links": [
            "8a79294f8c9e1bda"
        ],
        "x": 145,
        "y": 1540,
        "wires": [
            [
                "892664ccd686b134"
            ]
        ]
    },
    {
        "id": "892664ccd686b134",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "21275fd3a4c7913e",
        "name": "decide_price",
        "func": "if (msg.payload !== null) {\n    let vehicle_class = msg.payload[0];\n    let dsc = msg.payload[1];\n    let nok_kWh = msg.payload[2];\n    \n    // reward electric drivers on days with low electric prices\n    if (vehicle_class == \"Electric\") {\n        msg.payload = global.get(\"toll_electric\") * Math.E ** (100 * nok_kWh / dsc);\n    } else if (vehicle_class = \"Gasoline\") {\n        //msg.payload = global.get(\"toll_gasoline\") * Math.E ** (100 * nok_kWh / dsc);\n        msg.payload = 0;\n    } else if (vehicle_class = \"Service\") {\n        msg.payload = global.get(\"toll_service\") * Math.E ** (100 * nok_kWh / dsc);\n    }\n} else {\n    msg.payload = \"No such user/vehicle registered\";\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 1540,
        "wires": [
            [
                "a8858f8a4c84de28",
                "3eb8a7513cd893f0"
            ]
        ]
    },
    {
        "id": "3eb8a7513cd893f0",
        "type": "mqtt out",
        "z": "c7015bd55ac9c57d",
        "g": "21275fd3a4c7913e",
        "name": "",
        "topic": "carPrice",
        "qos": "2",
        "retain": "true",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "dc20097875203fb9",
        "x": 590,
        "y": 1600,
        "wires": []
    },
    {
        "id": "6d866f700464c477",
        "type": "inject",
        "z": "c7015bd55ac9c57d",
        "g": "21275fd3a4c7913e",
        "name": "resend_test",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "73.8272",
        "payloadType": "num",
        "x": 220,
        "y": 1600,
        "wires": [
            [
                "3eb8a7513cd893f0"
            ]
        ]
    },
    {
        "id": "a8858f8a4c84de28",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "21275fd3a4c7913e",
        "name": "debug 35",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 1540,
        "wires": []
    },
    {
        "id": "11e643123ec5b919",
        "type": "link out",
        "z": "c7015bd55ac9c57d",
        "g": "5454094dd1d0958e",
        "name": "get-price.output",
        "mode": "link",
        "links": [
            "b3c8efd25d693eb7",
            "0f60eb9b92962992",
            "53a77b9dde206ea2"
        ],
        "x": 1175,
        "y": 680,
        "wires": []
    },
    {
        "id": "6583d5f44e957ce0",
        "type": "link out",
        "z": "c7015bd55ac9c57d",
        "g": "5454094dd1d0958e",
        "name": "send_u_id_and_v_id",
        "mode": "link",
        "links": [
            "70ea88b87505faaa"
        ],
        "x": 875,
        "y": 740,
        "wires": []
    },
    {
        "id": "93a705171c063e17",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "5454094dd1d0958e",
        "name": "send_ids",
        "func": "msg.payload = {\n    u_id: flow.get(\"user_id\"),\n    t_id: flow.get(\"toll_id\"),\n    v_id: flow.get(\"car_id\") \n};\n\nmsg.topic = \"id\";\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 740,
        "wires": [
            [
                "6583d5f44e957ce0"
            ]
        ]
    },
    {
        "id": "308f248214133e70",
        "type": "ui-template",
        "z": "c7015bd55ac9c57d",
        "g": "dff9176621056133",
        "group": "78b509623ddc3923",
        "page": "",
        "ui": "",
        "name": "get_events",
        "order": 0,
        "width": 0,
        "height": 0,
        "head": "",
        "format": "<template>\n    <div>\n        <h2>{{ message }}</h2>\n        <p>Current Pressed Keys: {{ keys.join(', ') }}</p>\n    </div>\n</template>\n\n\n<script>\n    export default {\n        data() {\n            return {\n                loaded: false,\n                message: \"Remote control not operational.\",\n                keys: []\n            }\n        },\n        watch: {\n            loaded: function () {\n                if (this.loaded) {\n                    this.message = \"Remote control operational\";\n                }\n\n            }\n        },\n        \n        methods: {\n            onKeydown(event) {\n                if (event.repeat) {\n                    return;\n                } else if (!this.keys.includes(event.key)) {\n                    this.keys.push(event.key);\n                    this.sendKeys();\n                    console.log('Key down:', event.key);\n                }\n            },\n\n            onKeyUp(event) {\n                const index = this.keys.indexOf(event.key);\n                if (index > -1) {\n                    this.keys.splice(index, 1);\n                    this.sendKeys();\n                    console.log('Key up:', event.key);\n                } else {\n                    console.log('Key not found in array:', event.key);\n                }\n            },\n\n            sendKeys() {\n                this.send({ payload: this.keys });\n            }\n\n\n        },\n        mounted() {\n            document.addEventListener(\"keydown\", this.onKeydown);\n            document.addEventListener(\"keyup\", this.onKeyUp);\n            this.loaded = true;\n        },\n        unmounted() {\n            document.removeEventListener(\"keydown\", this.onKeydown);\n            document.removeEventListener(\"keyup\", this.onKeyUp);\n        }\n    }\n</script>\n<style>\n    .my-class {\n            width:200px;\n            height:20px;\n            background-color: blue;\n            top: 10%;\n            left: 50%;\n            margin-top: 100px;\n            margin-left: 100px;\n    }\n</style>\n\n\n",
        "storeOutMessages": true,
        "passthru": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 170,
        "y": 140,
        "wires": [
            [
                "e5c5cf0d6bb917c5",
                "e4f62c1015b6a187",
                "8955a8be5e602442"
            ]
        ]
    },
    {
        "id": "c5625aae3982120b",
        "type": "mqtt out",
        "z": "c7015bd55ac9c57d",
        "g": "c7906ff188775303",
        "name": "",
        "topic": "NOK_per_kWh",
        "qos": "2",
        "retain": "true",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "dc20097875203fb9",
        "x": 1020,
        "y": 960,
        "wires": []
    },
    {
        "id": "ed9b01e046d144e7",
        "type": "mqtt in",
        "z": "c7015bd55ac9c57d",
        "g": "c7906ff188775303",
        "name": "",
        "topic": "pricePing",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "dc20097875203fb9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 180,
        "y": 960,
        "wires": [
            [
                "46acc0101d9a3012"
            ]
        ]
    },
    {
        "id": "c299a20498ef6157",
        "type": "inject",
        "z": "c7015bd55ac9c57d",
        "g": "c7906ff188775303",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0.13282",
        "payloadType": "num",
        "x": 800,
        "y": 960,
        "wires": [
            [
                "c5625aae3982120b"
            ]
        ]
    },
    {
        "id": "50b307eb95867622",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "c7906ff188775303",
        "name": "debug 81",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1030,
        "y": 1020,
        "wires": []
    },
    {
        "id": "660a1d8987b9b7bb",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "c7906ff188775303",
        "name": "filter_price_to_toll_station",
        "func": "msg.payload = msg.payload.price;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 810,
        "y": 1040,
        "wires": [
            [
                "c5625aae3982120b",
                "50b307eb95867622"
            ]
        ]
    },
    {
        "id": "83478248c9afeea4",
        "type": "mqtt out",
        "z": "c7015bd55ac9c57d",
        "g": "c7906ff188775303",
        "name": "",
        "topic": "electricPrice",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "dc20097875203fb9",
        "x": 1010,
        "y": 1160,
        "wires": []
    },
    {
        "id": "f9013a522c1abdd8",
        "type": "mqtt out",
        "z": "c7015bd55ac9c57d",
        "g": "c7906ff188775303",
        "name": "",
        "topic": "gasolinePrice",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "dc20097875203fb9",
        "x": 1020,
        "y": 1220,
        "wires": []
    },
    {
        "id": "50366ad6532503c4",
        "type": "mqtt out",
        "z": "c7015bd55ac9c57d",
        "g": "c7906ff188775303",
        "name": "",
        "topic": "servicePrice",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "dc20097875203fb9",
        "x": 1010,
        "y": 1100,
        "wires": []
    },
    {
        "id": "c6e4d7cfcfad47e1",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "c7906ff188775303",
        "name": "return_service_price",
        "func": "msg.payload = global.get(\"toll_service\")\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 800,
        "y": 1100,
        "wires": [
            [
                "50366ad6532503c4"
            ]
        ]
    },
    {
        "id": "b4907d24f57876bb",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "c7906ff188775303",
        "name": "return_electric_price",
        "func": "msg.payload = global.get(\"toll_electric\")\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 800,
        "y": 1140,
        "wires": [
            [
                "83478248c9afeea4"
            ]
        ]
    },
    {
        "id": "c6b56c5e4cf401b5",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "c7906ff188775303",
        "name": "return_gasoline_price",
        "func": "msg.payload = global.get(\"toll_gasoline\");\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 760,
        "y": 1180,
        "wires": [
            [
                "f9013a522c1abdd8"
            ]
        ]
    },
    {
        "id": "a6ad1c1bf0c2f9b0",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "5454094dd1d0958e",
        "name": "debug 83",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 740,
        "y": 780,
        "wires": []
    },
    {
        "id": "249134f2a57f31e6",
        "type": "link out",
        "z": "c7015bd55ac9c57d",
        "g": "5454094dd1d0958e",
        "name": "communication.output.from_toll_station",
        "mode": "link",
        "links": [
            "6e8bd7cd38c95929"
        ],
        "x": 365,
        "y": 840,
        "wires": []
    },
    {
        "id": "6e8bd7cd38c95929",
        "type": "link in",
        "z": "c7015bd55ac9c57d",
        "g": "0e2e50fab3fb368c",
        "name": "communication.input.insert_transaction",
        "links": [
            "249134f2a57f31e6"
        ],
        "x": 145,
        "y": 1380,
        "wires": [
            [
                "3930943413a6acb5",
                "9125513fcaa2699c"
            ]
        ]
    },
    {
        "id": "3930943413a6acb5",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "0e2e50fab3fb368c",
        "name": "filter_message",
        "func": "let received_string = msg.payload;\n\nif (/Car 2 paid:/i.test(received_string)) {\n    msg.topic = \"cleared\";\n\n    //\"Toll ID: 1, Car ID: 3, driver ID: 3\"\n    // Car 2 paid: 19.22 NOK\n\n    const res = /Car ([0-9]+) paid: ([0-9]*\\.?[0-9]+) NOK/;\n\n\n    let regex_find = received_string.match(res);\n\n    let car_id = parseInt(regex_find[1], 10);\n    let amount = parseFloat(regex_find[2]);\n\n    msg.payload = {\n        user_id: car_id,\n        amount: amount\n    }\n\n} else if (/Car 1 has not been let/i.test(received_string)) {\n    msg.topic = \"not_allowed\";\n    msg.payload = \"\";\n    node.warn(\"Current vehicle not allowed through toll station\");\n} \n\n\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 580,
        "y": 1380,
        "wires": [
            [
                "54eb79583afd2a77",
                "2fdb2fe082259b37",
                "0ff79d5862a3a192"
            ]
        ]
    },
    {
        "id": "0ff79d5862a3a192",
        "type": "link out",
        "z": "c7015bd55ac9c57d",
        "g": "0e2e50fab3fb368c",
        "name": "communication.output.insert_transaction_on_user",
        "mode": "link",
        "links": [
            "be6997b1779be1cb"
        ],
        "x": 875,
        "y": 1380,
        "wires": []
    },
    {
        "id": "54eb79583afd2a77",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "0e2e50fab3fb368c",
        "name": "debug 90",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 820,
        "y": 1440,
        "wires": []
    },
    {
        "id": "2fdb2fe082259b37",
        "type": "link out",
        "z": "c7015bd55ac9c57d",
        "g": "0e2e50fab3fb368c",
        "name": "communication.output.car_not_allowed",
        "mode": "link",
        "links": [
            "c7142d427ef14ae9"
        ],
        "x": 875,
        "y": 1340,
        "wires": []
    },
    {
        "id": "53730560459116ec",
        "type": "http request",
        "z": "c7015bd55ac9c57d",
        "g": "c7906ff188775303",
        "name": "get_power_prices",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.hvakosterstrommen.no/api/v1/prices/{{{topic}}}.json ",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 390,
        "y": 1000,
        "wires": [
            [
                "1c71198eb632d947"
            ]
        ]
    },
    {
        "id": "1c71198eb632d947",
        "type": "json",
        "z": "c7015bd55ac9c57d",
        "g": "c7906ff188775303",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 530,
        "y": 1040,
        "wires": [
            [
                "957a6922777db625"
            ]
        ]
    },
    {
        "id": "957a6922777db625",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "c7906ff188775303",
        "name": "get_current_price",
        "func": "\n\nlet hour = new Date().getHours();\n\n\n\nlet prices = msg.payload;\n\nlet toll_info = {\n    price: prices[hour]['NOK_per_kWh'],\n    car_id: flow.get(\"car_id\"),\n    toll_id: flow.get(\"toll_id\")\n}\nmsg.topic = \"\"\nmsg.payload = toll_info;\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 1080,
        "wires": [
            [
                "660a1d8987b9b7bb",
                "c6e4d7cfcfad47e1",
                "b4907d24f57876bb",
                "c6b56c5e4cf401b5"
            ]
        ]
    },
    {
        "id": "46acc0101d9a3012",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "c7906ff188775303",
        "name": "simple_get_price",
        "func": "let date = new Date();\n\nflow.set(\"from_price_ping\", true);\n\n//let day = date.getDay().toLocaleString(\"no_NO\", options);\nlet day = date.toLocaleDateString(\"no-NO\", { day: \"2-digit\" }).slice(0, 2);\nlet month = date.toLocaleDateString(\"no-NO\", { month: \"2-digit\" }).slice(0, 2);\nlet year = date.getFullYear();\n\nmsg.topic = `${year}/${month}-${day}_NO5`;\n\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 230,
        "y": 1040,
        "wires": [
            [
                "53730560459116ec"
            ]
        ]
    },
    {
        "id": "9125513fcaa2699c",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "0e2e50fab3fb368c",
        "name": "debug 100",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 390,
        "y": 1440,
        "wires": []
    },
    {
        "id": "9de20b94d51e8a81",
        "type": "inject",
        "z": "c7015bd55ac9c57d",
        "g": "0e2e50fab3fb368c",
        "name": "carw1",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Car 1 has not been let through",
        "payloadType": "str",
        "x": 340,
        "y": 1360,
        "wires": [
            [
                "3930943413a6acb5"
            ]
        ]
    },
    {
        "id": "4c286d0a4cbe55d2",
        "type": "catch",
        "z": "c7015bd55ac9c57d",
        "g": "0e2e50fab3fb368c",
        "name": "",
        "scope": "group",
        "uncaught": false,
        "x": 390,
        "y": 1400,
        "wires": [
            [
                "3930943413a6acb5"
            ]
        ]
    },
    {
        "id": "f584a4b68256cfb5",
        "type": "mqtt in",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "",
        "topic": "esp32/led/value1",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "dc20097875203fb9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 240,
        "y": 2200,
        "wires": [
            [
                "3da3db495b46e423",
                "20e026677c68bd7b",
                "fd8b447bf519396b"
            ]
        ]
    },
    {
        "id": "4ecb82d421e1e537",
        "type": "mqtt in",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "",
        "topic": "esp32/led/value2",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "dc20097875203fb9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 240,
        "y": 2260,
        "wires": [
            [
                "3da3db495b46e423",
                "20e026677c68bd7b",
                "e80bf7ba3e2dd6c3"
            ]
        ]
    },
    {
        "id": "5a8e251b3584b916",
        "type": "mqtt in",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "",
        "topic": "esp32/led/value3",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "dc20097875203fb9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 240,
        "y": 2320,
        "wires": [
            [
                "3da3db495b46e423",
                "20e026677c68bd7b",
                "5cda82b0547e3d5f"
            ]
        ]
    },
    {
        "id": "6f5a50d2464f8b9d",
        "type": "mqtt in",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "",
        "topic": "esp32/weather1",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "dc20097875203fb9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 200,
        "y": 2740,
        "wires": [
            [
                "1e6243a71c3975d4",
                "aef2d89cedb36727"
            ]
        ]
    },
    {
        "id": "83455dfa39324952",
        "type": "mqtt in",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "",
        "topic": "esp32/weather2",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "dc20097875203fb9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 200,
        "y": 2800,
        "wires": [
            [
                "1e6243a71c3975d4",
                "2c8d18f302ac3197"
            ]
        ]
    },
    {
        "id": "6867b32ed421a65b",
        "type": "mqtt in",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "",
        "topic": "esp32/weather3",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "dc20097875203fb9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 200,
        "y": 2860,
        "wires": [
            [
                "1e6243a71c3975d4",
                "3356be1c031e3e84"
            ]
        ]
    },
    {
        "id": "fe453aeef45b1417",
        "type": "mqtt in",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "",
        "topic": "esp32/powersupply/value1",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "dc20097875203fb9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 250,
        "y": 1880,
        "wires": [
            [
                "02b7c48b5e854a1a",
                "39399d0e48774684"
            ]
        ]
    },
    {
        "id": "51a9f59e2ff22e1d",
        "type": "mqtt in",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "",
        "topic": "esp32/powersupply/value2",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "dc20097875203fb9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 250,
        "y": 1940,
        "wires": [
            [
                "02b7c48b5e854a1a",
                "8ea8dd53a495a2bf"
            ]
        ]
    },
    {
        "id": "294141438e9d3d04",
        "type": "mqtt in",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "",
        "topic": "esp32/powersupply/value3",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "dc20097875203fb9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 250,
        "y": 2000,
        "wires": [
            [
                "02b7c48b5e854a1a",
                "e029ce6434ae6809"
            ]
        ]
    },
    {
        "id": "7c5fc2a9159033fa",
        "type": "inject",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "emulate_available_charge_station2",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "esp32/led/value2",
        "payload": "Opptatt, User ID: 1, Station ID: 1",
        "payloadType": "str",
        "x": 260,
        "y": 2520,
        "wires": [
            [
                "3da3db495b46e423"
            ]
        ]
    },
    {
        "id": "4a243c07d4bb3d89",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "6a95e8aa54c858ac",
        "name": "regex_match",
        "func": "\n// \"Opptatt, User ID: 1, Station ID: 1\"\n\n\nlet received_msg = msg.payload;\n\nconst reg = /(\\w+), User ID: ([0-9]+), Station ID: ([0-9]+)/;\n\nlet regex_find = received_msg.match(reg);\n\nlet availability = regex_find[1];\nlet user_id = parseInt(regex_find[2],10);\nlet station_id = parseInt(regex_find[3],10);\n\nif (availability === \"Opptatt\") {\n    msg.topic = \"begin_charing\";\n} else {\n    msg.topic = \"end_charging\";\n}\n\nlet msg_obj = {\n    avl: availability,\n    u_id: user_id,\n    s_id: station_id\n};\n\nmsg.payload = msg_obj;\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1390,
        "y": 1880,
        "wires": [
            [
                "238096ea929842a9"
            ]
        ]
    },
    {
        "id": "238096ea929842a9",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "6a95e8aa54c858ac",
        "name": "debug 57",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1560,
        "y": 1880,
        "wires": []
    },
    {
        "id": "3e6aaa8a256b8c8f",
        "type": "switch",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "",
        "property": "payload.available",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Opptatt",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Ledig",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 750,
        "y": 2460,
        "wires": [
            [
                "1bfb51ebb430b759"
            ],
            [
                "23b4e448863048a3",
                "9715f242360c1c97"
            ]
        ]
    },
    {
        "id": "fcc679d18dbe9066",
        "type": "inject",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "emulate_charging_no_charge",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0, User ID: 2, Station ID: 1\"",
        "payloadType": "str",
        "x": 260,
        "y": 2060,
        "wires": [
            [
                "02b7c48b5e854a1a"
            ]
        ]
    },
    {
        "id": "23f5fdbd7fa84225",
        "type": "inject",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "emulate_available_charge_station1",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "esp32/led/value1",
        "payload": "Ledig, User ID: 1, Station ID: 1",
        "payloadType": "str",
        "x": 260,
        "y": 2480,
        "wires": [
            [
                "3da3db495b46e423",
                "20e026677c68bd7b"
            ]
        ]
    },
    {
        "id": "3da3db495b46e423",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "filter_incoming_msg",
        "func": "let spot = null;\n\nif (msg.topic === \"esp32/led/value1\") {\n    spot = 1;\n} \nswitch (msg.topic) {\n    case \"esp32/led/value1\":\n        spot = 1;\n        break;\n    case \"esp32/led/value2\":\n        spot = 2;\n        break;\n    case \"esp32/led/value3\":\n        spot = 3;\n        break;\n    default:\n    spot = 0;\n} \n\n// \"Opptatt, User ID: 1, Station ID: 1\"\nlet received_msg = msg.payload;\n\nconst reg = /(\\w+), User ID: ([0-9]+), Station ID: ([0-9]+)/;\n\nlet regex_find = received_msg.match(reg);\n\nlet availability = regex_find[1];\nlet user_id = parseInt(regex_find[2], 10);\nlet station_id = parseInt(regex_find[3], 10);\n\nif (availability === \"Opptatt\") {\n    msg.topic = \"begin_charing\";\n} else {\n    msg.topic = \"end_charging\";\n}\n\nlet msg_obj = {\n    available: availability,\n    u_id: user_id,\n    s_id: station_id,\n    spot: spot\n};\n\nmsg.payload = msg_obj;\n\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 580,
        "y": 2460,
        "wires": [
            [
                "3e6aaa8a256b8c8f",
                "1bfb51ebb430b759",
                "23b4e448863048a3",
                "9715f242360c1c97"
            ]
        ]
    },
    {
        "id": "23b4e448863048a3",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "debug 62",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 980,
        "y": 2460,
        "wires": []
    },
    {
        "id": "02b7c48b5e854a1a",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "get_charge",
        "func": "let spot = null;\n\nswitch (msg.topic) {\n    case \"esp32/powersupply/value1\":\n        spot = 1;\n        break;\n    case \"esp32/powersupply/value2\":\n        spot = 2;\n        break;\n    case \"esp32/powersupply/value3\":\n        spot = 3;\n        break;\n    default:\n        spot = 0;\n}\n\nflow.set(\"spot\", spot);\n\n\n// \"Opptatt, User ID: 1, Station ID: 1\"\nlet received_msg = msg.payload;\n\nif (received_msg === \"Lading ikke tilgjengelig\") {\n    flow.set(\"stop_charging\", true);\n}\n\nconst reg = /([0-9]*\\.?[0-9]+), User ID: ([0-9]+), Station ID: ([0-9]+)/;\n\nlet regex_find = received_msg.match(reg);\n\nlet current_charge = parseFloat(regex_find[1]);\nlet user_id = parseInt(regex_find[2], 10);\nlet station_id = parseInt(regex_find[3], 10);\n\nflow.set(\"charge\", current_charge);\nflow.set(\"u_id\", user_id);\nflow.set(\"s_id\", station_id);\n\nmsg.payload = null;\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 610,
        "y": 2080,
        "wires": [
            [
                "9c13ce0ea3ea12b4",
                "1bfb51ebb430b759",
                "9715f242360c1c97"
            ]
        ]
    },
    {
        "id": "9c13ce0ea3ea12b4",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "debug 63",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 800,
        "y": 2080,
        "wires": []
    },
    {
        "id": "251a0a65d7069398",
        "type": "switch",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "true"
            },
            {
                "t": "eq",
                "v": "cancel",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 1230,
        "y": 2400,
        "wires": [
            [
                "92aca90c4405a617"
            ],
            [
                "a7ef2574578de56d",
                "f0a06994da576122"
            ],
            [
                "ed2ad7e7d6998b33"
            ]
        ]
    },
    {
        "id": "bd1541638d4772dc",
        "type": "delay",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "wait_for_charge_start",
        "pauseType": "delay",
        "timeout": "1000",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1020,
        "y": 2340,
        "wires": [
            [
                "1bfb51ebb430b759",
                "678ef6e30af00481"
            ]
        ]
    },
    {
        "id": "a7ef2574578de56d",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "debug 64",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1460,
        "y": 2360,
        "wires": []
    },
    {
        "id": "92aca90c4405a617",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "refresh_first_uid",
        "func": "msg.payload.u_id_from_other = msg.payload.u_id_from_other;\n\nmsg.topic = \"refresh_first_uid\";\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1440,
        "y": 2280,
        "wires": [
            [
                "bd1541638d4772dc",
                "8909798ad584083f",
                "1bfb51ebb430b759",
                "678ef6e30af00481"
            ]
        ]
    },
    {
        "id": "f0a06994da576122",
        "type": "link out",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "communication.chargestation.output.start_charging",
        "mode": "link",
        "links": [
            "4d138347c7b68093"
        ],
        "x": 1465,
        "y": 2400,
        "wires": []
    },
    {
        "id": "ed2ad7e7d6998b33",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "function 9",
        "func": "msg.payload = \"cancel\";\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1420,
        "y": 2440,
        "wires": [
            []
        ]
    },
    {
        "id": "259641d5ce583eb5",
        "type": "catch",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "",
        "scope": "group",
        "uncaught": false,
        "x": 730,
        "y": 2380,
        "wires": [
            [
                "1bfb51ebb430b759"
            ]
        ]
    },
    {
        "id": "b68accdce12ce7eb",
        "type": "inject",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "emulate_charging_with_charge",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "esp32/powersupply/value2",
        "payload": "598.498, User ID: 1, Station ID: 1\"",
        "payloadType": "str",
        "x": 270,
        "y": 2120,
        "wires": [
            [
                "02b7c48b5e854a1a",
                "9c13ce0ea3ea12b4",
                "1bfb51ebb430b759",
                "9715f242360c1c97"
            ]
        ]
    },
    {
        "id": "1bfb51ebb430b759",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "check_if_ok_to_start_charge",
        "func": "if (msg.payload !== null) {\n    flow.set(\"u_id_from_available_call\", msg.payload.u_id);\n}\n\n\n\nlet user_id = null;\nlet m_stat = null;\n\nif (msg.topic === \"refresh_first_uid\") {\n    flow.set(\"u_id_from_available_call\", msg.payload.u_id_from_other);\n}\n\n\nuser_id = flow.get(\"u_id\");\nlet charge_value = flow.get(\"charge\");\n\n//if (user_id === undefined) {\n//    node.warn(\"no user_id from get_charge found\");\n//    m_stat = false;\n//}\n\n\nif (charge_value === 0 || user_id === undefined) {\n    m_stat = false;\n} else {    \n    if (user_id == flow.get(\"u_id_from_available_call\")) {\n        m_stat = true;\n    } else {\n        node.warn(\"User ID not matching, cancel current request.\");\n        m_stat = \"cancel\";\n    }\n}\n\nlet msg_obj = {\n    status: m_stat,\n    uid: user_id,\n    u_id_from_other: flow.get(\"u_id_from_available_call\"),\n    ch_val: charge_value,\n    spot: flow.get(\"spot\"),\n    station: flow.get(\"s_id\")\n}\n\nmsg.payload = msg_obj;\n\n//msg.payload = flow.get(\"u_id_from_available_call\");\n//msg.payload = flow.get(\"charge\") * msg.payload.price1;\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1040,
        "y": 2400,
        "wires": [
            [
                "251a0a65d7069398",
                "a7ef2574578de56d",
                "92aca90c4405a617",
                "f0a06994da576122",
                "ed2ad7e7d6998b33"
            ]
        ]
    },
    {
        "id": "8909798ad584083f",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "debug 68",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1620,
        "y": 2280,
        "wires": []
    },
    {
        "id": "678ef6e30af00481",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "6a95e8aa54c858ac",
        "name": "debug 69",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1220,
        "y": 2340,
        "wires": []
    },
    {
        "id": "9715f242360c1c97",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "stopped_charging",
        "func": "if (msg.payload === null) {\n    return null;\n} else {\n    msg.payload = msg.payload;\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1010,
        "y": 2540,
        "wires": [
            [
                "60256e9b498b8dd5",
                "48a4a3c3dd98820c"
            ]
        ]
    },
    {
        "id": "60256e9b498b8dd5",
        "type": "link out",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "6a95e8aa54c858ac",
        "name": "communication.output.stop_charging",
        "mode": "link",
        "links": [
            "f33f70cd07956bd8"
        ],
        "x": 1165,
        "y": 2540,
        "wires": []
    },
    {
        "id": "48a4a3c3dd98820c",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "d": true,
        "g": "6a95e8aa54c858ac",
        "name": "debug 75",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1220,
        "y": 2580,
        "wires": []
    },
    {
        "id": "d37374ec32398ba1",
        "type": "link out",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "communication.output.weather_out",
        "mode": "link",
        "links": [
            "02ae78a50512873e"
        ],
        "x": 645,
        "y": 2720,
        "wires": []
    },
    {
        "id": "89b42281cdae4137",
        "type": "inject",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "emulate_weather",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "esp32/weather1",
        "payload": "Delvis skyet",
        "payloadType": "str",
        "x": 200,
        "y": 2640,
        "wires": [
            [
                "1e6243a71c3975d4"
            ]
        ]
    },
    {
        "id": "1e6243a71c3975d4",
        "type": "function",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "split",
        "func": "\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 2720,
        "wires": [
            [
                "d37374ec32398ba1"
            ]
        ]
    },
    {
        "id": "20e026677c68bd7b",
        "type": "link out",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "communication.output.display_charge_status",
        "mode": "link",
        "links": [
            "534a1b47f4d8f647"
        ],
        "x": 575,
        "y": 2260,
        "wires": []
    },
    {
        "id": "39399d0e48774684",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "debug 91",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 1880,
        "wires": []
    },
    {
        "id": "8ea8dd53a495a2bf",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "debug 92",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 560,
        "y": 1940,
        "wires": []
    },
    {
        "id": "e029ce6434ae6809",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "debug 93",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 570,
        "y": 2000,
        "wires": []
    },
    {
        "id": "aef2d89cedb36727",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "debug 94",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 450,
        "y": 2760,
        "wires": []
    },
    {
        "id": "2c8d18f302ac3197",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "debug 95",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 470,
        "y": 2820,
        "wires": []
    },
    {
        "id": "fd8b447bf519396b",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "debug 96",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 550,
        "y": 2180,
        "wires": []
    },
    {
        "id": "e80bf7ba3e2dd6c3",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "debug 97",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 550,
        "y": 2320,
        "wires": []
    },
    {
        "id": "5cda82b0547e3d5f",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "debug 98",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 540,
        "y": 2360,
        "wires": []
    },
    {
        "id": "3356be1c031e3e84",
        "type": "debug",
        "z": "c7015bd55ac9c57d",
        "g": "6a95e8aa54c858ac",
        "name": "debug 99",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 2860,
        "wires": []
    },
    {
        "id": "77ef07ddbc346c22",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "8d23dc769da0d07f",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 420,
        "y": 80,
        "wires": [
            [
                "a5837349ffd6fca1"
            ]
        ]
    },
    {
        "id": "22308172980d6de6",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "8d23dc769da0d07f",
        "name": "getUsers",
        "func": "msg.topic = `\nSELECT u.id, u.name, u.email, u.address, u.tlf, AVG(e.score) AS score \nFROM ecoscore e LEFT JOIN users u ON user_id = u.id\nGROUP BY u.id;\n`;\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 260,
        "y": 80,
        "wires": [
            [
                "77ef07ddbc346c22"
            ]
        ]
    },
    {
        "id": "a5837349ffd6fca1",
        "type": "link out",
        "z": "d974087eb4410441",
        "g": "8d23dc769da0d07f",
        "name": "db.output.getusers",
        "mode": "link",
        "links": [
            "33998569dd15990e"
        ],
        "x": 535,
        "y": 80,
        "wires": []
    },
    {
        "id": "2bd950a05a93757a",
        "type": "link in",
        "z": "d974087eb4410441",
        "g": "8d23dc769da0d07f",
        "name": "db.input.getusers",
        "links": [
            "f088635e3f42d421"
        ],
        "x": 135,
        "y": 80,
        "wires": [
            [
                "22308172980d6de6"
            ]
        ]
    },
    {
        "id": "1236e3bf163b4142",
        "type": "link in",
        "z": "d974087eb4410441",
        "d": true,
        "g": "c9965334e0b36a0b",
        "name": "link in 5",
        "links": [
            "038b288f4ba869de"
        ],
        "x": 105,
        "y": 1860,
        "wires": [
            [
                "6f161c9edf33ba3d"
            ]
        ]
    },
    {
        "id": "eb6d2cad886648e8",
        "type": "link in",
        "z": "d974087eb4410441",
        "d": true,
        "g": "c9965334e0b36a0b",
        "name": "link in 6",
        "links": [
            "2f4b2f43ca14af61"
        ],
        "x": 105,
        "y": 1920,
        "wires": [
            [
                "fbb060fd70043410"
            ]
        ]
    },
    {
        "id": "e893b7685905402d",
        "type": "link in",
        "z": "d974087eb4410441",
        "d": true,
        "g": "c9965334e0b36a0b",
        "name": "link in 7",
        "links": [
            "b27aeb6f7cd37378"
        ],
        "x": 105,
        "y": 1980,
        "wires": [
            [
                "8f11c965debd450e"
            ]
        ]
    },
    {
        "id": "6f161c9edf33ba3d",
        "type": "debug",
        "z": "d974087eb4410441",
        "d": true,
        "g": "c9965334e0b36a0b",
        "name": "distance",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 270,
        "y": 1860,
        "wires": []
    },
    {
        "id": "fbb060fd70043410",
        "type": "debug",
        "z": "d974087eb4410441",
        "d": true,
        "g": "c9965334e0b36a0b",
        "name": "speed",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 260,
        "y": 1920,
        "wires": []
    },
    {
        "id": "8f11c965debd450e",
        "type": "debug",
        "z": "d974087eb4410441",
        "d": true,
        "g": "c9965334e0b36a0b",
        "name": "score",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 260,
        "y": 1980,
        "wires": []
    },
    {
        "id": "f1c8edc3f112fcf2",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "7c5378ce3d8e1fab",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 460,
        "y": 440,
        "wires": [
            [
                "6578372151a0df87"
            ]
        ]
    },
    {
        "id": "06dc7761e9b36e06",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "7c5378ce3d8e1fab",
        "name": "get_driving_score",
        "func": "let user_id = flow.get(\"user_id\");\nlet toll_id = flow.get(\"toll_id\");\n\n\nmsg.topic = `\nSELECT t.id, p.id, p.NOK_per_kWh FROM relations r \nLEFT JOIN powerprices p ON r.pcost_id = p.id\nLEFT JOIN tollstation t ON r.toll_id = t.id\nWHERE t.id = ${toll_id}\nORDER BY p.id DESC\nLIMIT 1;\n`;\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 290,
        "y": 440,
        "wires": [
            [
                "f1c8edc3f112fcf2"
            ]
        ]
    },
    {
        "id": "8a79294f8c9e1bda",
        "type": "link out",
        "z": "d974087eb4410441",
        "g": "7c5378ce3d8e1fab",
        "name": "db.toll-station.output",
        "mode": "link",
        "links": [
            "56faac02af1e3921"
        ],
        "x": 1165,
        "y": 440,
        "wires": []
    },
    {
        "id": "b3c8efd25d693eb7",
        "type": "link in",
        "z": "d974087eb4410441",
        "g": "fa423b6c44026824",
        "name": "link in 9",
        "links": [
            "11e643123ec5b919"
        ],
        "x": 165,
        "y": 260,
        "wires": [
            [
                "2fa7fa16.df7d36",
                "6deff2c3917ab08e",
                "6c75f5e6b0bae9ef"
            ]
        ]
    },
    {
        "id": "2fa7fa16.df7d36",
        "type": "function",
        "z": "d974087eb4410441",
        "d": true,
        "g": "fa423b6c44026824",
        "name": "insert_toll",
        "func": "let car_id = msg.payload.car_id;\n\nflow.set(\"vehicle_id\", car_id);\n\nmsg.payload=[\"good day\", car_id];\nmsg.topic=\"INSERT INTO toll (`info`, `car_id`) VALUES (?, ?);\";\nreturn msg;\n\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 220,
        "wires": [
            [
                "8c41d7d6d675747c"
            ]
        ]
    },
    {
        "id": "8c41d7d6d675747c",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "fa423b6c44026824",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 500,
        "y": 260,
        "wires": [
            [
                "20fc10f82e1fbb3c",
                "bd2be327c3068176"
            ]
        ]
    },
    {
        "id": "6deff2c3917ab08e",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "fa423b6c44026824",
        "name": "insert_price",
        "func": "let price = msg.payload.price;\n\nmsg.payload = [price];\nmsg.topic = \"INSERT INTO powerprices (`NOK_per_kWh`) VALUES (?);\";\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 260,
        "wires": [
            [
                "8c41d7d6d675747c"
            ]
        ]
    },
    {
        "id": "20fc10f82e1fbb3c",
        "type": "function",
        "z": "d974087eb4410441",
        "d": true,
        "g": "fa423b6c44026824",
        "name": "insert_coupling_table",
        "func": "let toll_id = null;\nlet price_id = null;\n\nif (/INSERT INTO toll/i.test(msg.topic)) {\n    flow.set(\"toll_id\", msg.payload.insertId);   \n}\n\nif (/INSERT INTO powerprices/i.test(msg.topic)) {\n    flow.set(\"price_id\", msg.payload.insertId);\n}\n\ntoll_id = flow.get(\"toll_id\");\nprice_id = flow.get(\"price_id\");\n\nif (toll_id && price_id) {\n    msg.payload = [toll_id, price_id];\n    msg.topic = msg.topic = \"INSERT INTO coupling (`tr_id`, `toll_id`, `pcost_id`) VALUES (NULL, ?, ?);\";\n\n    flow.set(\"toll_id\", null);\n    flow.set(\"price_id\", null);\n\n    return msg;\n} else {\n    return null;\n}",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 720,
        "y": 260,
        "wires": [
            [
                "465b90c9e7577fdd"
            ]
        ]
    },
    {
        "id": "f5f52c154dc1c527",
        "type": "debug",
        "z": "d974087eb4410441",
        "g": "fa423b6c44026824",
        "name": "debug 40",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1110,
        "y": 260,
        "wires": []
    },
    {
        "id": "465b90c9e7577fdd",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "fa423b6c44026824",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 920,
        "y": 260,
        "wires": [
            [
                "f5f52c154dc1c527",
                "b8b5793024a68019",
                "fef5e4ca78ea74f7"
            ]
        ]
    },
    {
        "id": "b8b5793024a68019",
        "type": "link out",
        "z": "d974087eb4410441",
        "g": "fa423b6c44026824",
        "name": "db.output.completed_insert_prices",
        "mode": "link",
        "links": [
            "2492751851d4ab57"
        ],
        "x": 1055,
        "y": 300,
        "wires": []
    },
    {
        "id": "2492751851d4ab57",
        "type": "link in",
        "z": "d974087eb4410441",
        "g": "7c5378ce3d8e1fab",
        "name": "link in 10",
        "links": [
            "b8b5793024a68019"
        ],
        "x": 165,
        "y": 440,
        "wires": [
            [
                "06dc7761e9b36e06"
            ]
        ]
    },
    {
        "id": "bd683dfaf575d92b",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "7c5378ce3d8e1fab",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 820,
        "y": 440,
        "wires": [
            [
                "8ff91e6586ddbeb6"
            ]
        ]
    },
    {
        "id": "6578372151a0df87",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "7c5378ce3d8e1fab",
        "name": "get_based_on_uid",
        "func": "let c_id;\nlet u_id;\n\n\nif (msg.topic == \"id\"){\n    flow.set(\"user_id\", msg.payload.u_id);\n    flow.set(\"car_id\", msg.payload.v_id);\n    return null;\n} else {\n    c_id = flow.get(\"car_id\");\n    u_id = flow.get(\"user_id\");    \n\n    let price = msg.payload[0]['NOK_per_kWh'];\n    flow.set(\"NOK_kWh\", price);\n    msg.payload = [u_id, c_id];\n\n    msg.topic = `\n    SELECT v.id, v.vehicle_type, AVG(e.score) AS score FROM vehicles v \n    LEFT JOIN users u ON v.owner_id = u.id\n    LEFT JOIN ecoscore e ON e.user_id = u.id\n    WHERE u.id = ? AND v.id = ?;\n    `;\n\n} \n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 650,
        "y": 440,
        "wires": [
            [
                "2311204e8aeb792a",
                "bd683dfaf575d92b"
            ]
        ]
    },
    {
        "id": "8ff91e6586ddbeb6",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "7c5378ce3d8e1fab",
        "name": "sort_variables",
        "func": "let type = msg.payload[0]['vehicle_type'];\nlet eco_score = msg.payload[0]['score'];\nlet p = flow.get(\"NOK_kWh\");\n\n\nmsg.payload = [type, eco_score, p]\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1000,
        "y": 440,
        "wires": [
            [
                "8a79294f8c9e1bda"
            ]
        ]
    },
    {
        "id": "f6d3906734b58c4b",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "1060263491f37862",
        "name": "get_toll_prices",
        "func": "let station_id = null;\n\n\nif (msg.topic == \"request_from_toll_prices\") {\n    station_id = global.get(\"selected_toll_station\");\n} else {\n    station_id = flow.get(\"toll_id\");\n}\n\nmsg.payload=[station_id];\n\nmsg.topic = `SELECT id, location, electric_price, gasoline_price, service_price FROM tollstation t\nWHERE id = ?;`\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 380,
        "y": 600,
        "wires": [
            [
                "e8c5ccf60952c2be"
            ]
        ]
    },
    {
        "id": "2d95327a837381a2",
        "type": "debug",
        "z": "d974087eb4410441",
        "g": "1060263491f37862",
        "name": "debug 49",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1100,
        "y": 600,
        "wires": []
    },
    {
        "id": "e8c5ccf60952c2be",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "1060263491f37862",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 580,
        "y": 600,
        "wires": [
            [
                "a501c4b70711fc78"
            ]
        ]
    },
    {
        "id": "0f60eb9b92962992",
        "type": "link in",
        "z": "d974087eb4410441",
        "g": "1060263491f37862",
        "name": "db.input.get_toll_prices",
        "links": [
            "11e643123ec5b919"
        ],
        "x": 155,
        "y": 600,
        "wires": [
            [
                "f6d3906734b58c4b"
            ]
        ]
    },
    {
        "id": "a501c4b70711fc78",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "1060263491f37862",
        "name": "set_global",
        "func": "if (msg.payload.length === 0) {\n    msg.payload = \"No such station exist\";\n    msg.topic = \"id_error\";\n} else {\n    let toll_electric_price = msg.payload[0]['electric_price'];\n    let toll_gasoline_price = msg.payload[0]['gasoline_price'];\n    let toll_service_price = msg.payload[0]['service_price'];\n\n    global.set(\"toll_electric\", toll_electric_price);\n    global.set(\"toll_gasoline\", toll_gasoline_price);\n    global.set(\"toll_service\", toll_service_price);\n    \n    let station_info = {\n        id : msg.payload[0]['id'],\n        location: msg.payload[0]['location']\n    };\n\n    msg.payload = msg.payload[0]['location'];\n    \n    msg.topic = \"ok\";\n}\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 600,
        "wires": [
            [
                "2d95327a837381a2",
                "f82bd2713bd5bea4"
            ]
        ]
    },
    {
        "id": "e1c49e9771213b10",
        "type": "link in",
        "z": "d974087eb4410441",
        "g": "1060263491f37862",
        "name": "db.input.get_toll_prices_2",
        "links": [
            "d9f5b4ebe6ceadec"
        ],
        "x": 155,
        "y": 660,
        "wires": [
            [
                "f6d3906734b58c4b"
            ]
        ]
    },
    {
        "id": "f82bd2713bd5bea4",
        "type": "link out",
        "z": "d974087eb4410441",
        "g": "1060263491f37862",
        "name": "db.prices.updated",
        "mode": "link",
        "links": [
            "b3df72d8dcb2bc3a"
        ],
        "x": 975,
        "y": 660,
        "wires": []
    },
    {
        "id": "bd2be327c3068176",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "fa423b6c44026824",
        "name": "insert_relations_table",
        "func": "let station_id = flow.get(\"toll_id\");\nlet price_id = null;\n\nif (/INSERT INTO powerprices/i.test(msg.topic)) {\n    flow.set(\"price_id\", msg.payload.insertId);\n}\n\nprice_id = flow.get(\"price_id\");\nmsg.payload = station_id;\nif (station_id && price_id) {\n    msg.payload = [station_id, price_id];\n    msg.topic = \"INSERT INTO relations (`tr_id`, `toll_id`, `pcost_id`, `cr_id`) VALUES (NULL, ?, ?, NULL);\";\n\n    //flow.set(\"toll_id\", null);\n    flow.set(\"price_id\", null);\n\n    return msg;\n} else {\n    return null;\n}",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 720,
        "y": 300,
        "wires": [
            [
                "465b90c9e7577fdd"
            ]
        ]
    },
    {
        "id": "6c75f5e6b0bae9ef",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "fa423b6c44026824",
        "name": "get_toll_id",
        "func": "let id = msg.payload.toll_id;\nflow.set(\"toll_id\", id);\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 300,
        "wires": [
            [
                "bd2be327c3068176"
            ]
        ]
    },
    {
        "id": "70ea88b87505faaa",
        "type": "link in",
        "z": "d974087eb4410441",
        "g": "7c5378ce3d8e1fab",
        "name": "link in 11",
        "links": [
            "6583d5f44e957ce0"
        ],
        "x": 505,
        "y": 500,
        "wires": [
            [
                "6578372151a0df87"
            ]
        ]
    },
    {
        "id": "2311204e8aeb792a",
        "type": "debug",
        "z": "d974087eb4410441",
        "g": "7c5378ce3d8e1fab",
        "name": "debug 54",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 820,
        "y": 500,
        "wires": []
    },
    {
        "id": "681cc84e5c74f62f",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "9939226cfed744ae",
        "name": "insert_charge_record",
        "func": "let received_obj = msg.payload;\n\nif (msg.payload[0].count_id > 0) {\n    return null;\n}\n\n\n//let spot = received_obj.spot;\n//let station_id = received_obj.station;\n//let charged_value = received_obj.ch_val;\n\n\nlet spot = flow.get(\"spot\");\nlet station_id = flow.get(\"s_id\");\nlet charged_value = flow.get(\"charge\");\n\n\n\nmsg.payload=[spot, station_id, charged_value];\n\nmsg.topic = `\nINSERT INTO chargerecords (parking_spot, station_id, start_charge) VALUES\n(?, ?, ?);\n`\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 480,
        "y": 1240,
        "wires": [
            [
                "0b961f7bd67c5a6d"
            ]
        ]
    },
    {
        "id": "4d138347c7b68093",
        "type": "link in",
        "z": "d974087eb4410441",
        "g": "9939226cfed744ae",
        "name": "link in 13",
        "links": [
            "f0a06994da576122"
        ],
        "x": 145,
        "y": 1200,
        "wires": [
            [
                "36f3a52d4639e8b9"
            ]
        ]
    },
    {
        "id": "48b7e43ac0572c19",
        "type": "debug",
        "z": "d974087eb4410441",
        "g": "9939226cfed744ae",
        "name": "debug 70",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1080,
        "y": 1200,
        "wires": []
    },
    {
        "id": "0b961f7bd67c5a6d",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "9939226cfed744ae",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 660,
        "y": 1240,
        "wires": [
            [
                "339c8a7199811e95",
                "5adf0c52630de6c2"
            ]
        ]
    },
    {
        "id": "339c8a7199811e95",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "9939226cfed744ae",
        "name": "populate_relations_table",
        "func": "let prev_record = msg.payload.insertId;\n\nmsg.payload = [prev_record];\n\nmsg.topic = \"INSERT INTO relations (`tr_id`, `toll_id`, `pcost_id`, `cr_id`) VALUES (NULL, NULL, NULL, ?);\";\n\n\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 750,
        "y": 1200,
        "wires": [
            [
                "1c1f1601857b064c"
            ]
        ]
    },
    {
        "id": "5adf0c52630de6c2",
        "type": "debug",
        "z": "d974087eb4410441",
        "g": "9939226cfed744ae",
        "name": "debug 71",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 820,
        "y": 1240,
        "wires": []
    },
    {
        "id": "1c1f1601857b064c",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "9939226cfed744ae",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 940,
        "y": 1200,
        "wires": [
            [
                "48b7e43ac0572c19"
            ]
        ]
    },
    {
        "id": "36f3a52d4639e8b9",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "9939226cfed744ae",
        "name": "check_if_already_in_progress",
        "func": "let m = msg.payload;\nflow.set(\"spot\", m.spot);\nflow.set(\"charge\", m.ch_val);\nflow.set(\"s_id\", m.station);\nflow.set(\"uid\", m.uid);\n\nmsg.payload = [m.spot, m.station]\n\nmsg.topic = `\nSELECT COUNT(cr.id) AS count_id FROM chargerecords cr\nWHERE cr.parking_spot = ?\nAND cr.station_id = ? \nAND cr.to_time IS NULL\n`\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 310,
        "y": 1200,
        "wires": [
            [
                "d87ad496b027c132"
            ]
        ]
    },
    {
        "id": "a86da9f0852228de",
        "type": "debug",
        "z": "d974087eb4410441",
        "g": "9939226cfed744ae",
        "name": "debug 72",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 440,
        "y": 1280,
        "wires": []
    },
    {
        "id": "d87ad496b027c132",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "9939226cfed744ae",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 260,
        "y": 1240,
        "wires": [
            [
                "a86da9f0852228de",
                "681cc84e5c74f62f"
            ]
        ]
    },
    {
        "id": "684afc80e9bd7aa7",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "f869eda640303ea9",
        "name": "update_charge_record",
        "func": "let m = msg.payload;\n\nflow.set(\"u_id\", msg.payload.u_id);\n\nlet ch_val = flow.get(\"charge\");\n\n// 2024-06-05 09:00:00.000\n\n// 2024-06-03T19:43:27.477Z\n\nif (m.s_id === flow.get(\"s_id\")) {\n    msg.payload = [\n        new Date().toISOString().slice(0, 19).replace('T', ' '),\n        ch_val,\n        m.spot,\n        m.s_id\n    ];\n} else {\n    return null;\n}\n\n//msg.payload = [\n//    new Date().toISOString(),\n//    ch_val,\n//    m.spot,\n//    m.s_id\n//];\n\n\nmsg.topic = `\nUPDATE chargerecords \nSET to_time = ?, end_charge = ?\nWHERE parking_spot = ?\nAND station_id = ?\nAND to_time IS NULL;\n`;\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 320,
        "y": 1400,
        "wires": [
            [
                "8c7190358fbefe98"
            ]
        ]
    },
    {
        "id": "f33f70cd07956bd8",
        "type": "link in",
        "z": "d974087eb4410441",
        "g": "f869eda640303ea9",
        "name": "link in 14",
        "links": [
            "60256e9b498b8dd5"
        ],
        "x": 145,
        "y": 1400,
        "wires": [
            [
                "684afc80e9bd7aa7",
                "e1ddf0cb76206c25"
            ]
        ]
    },
    {
        "id": "f8490ccc66c6627f",
        "type": "debug",
        "z": "d974087eb4410441",
        "g": "f869eda640303ea9",
        "name": "debug 73",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 1440,
        "wires": []
    },
    {
        "id": "8c7190358fbefe98",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "f869eda640303ea9",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 420,
        "y": 1440,
        "wires": [
            [
                "f8490ccc66c6627f",
                "e4955c44e4805be0"
            ]
        ]
    },
    {
        "id": "e1ddf0cb76206c25",
        "type": "debug",
        "z": "d974087eb4410441",
        "g": "f869eda640303ea9",
        "name": "debug 74",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 260,
        "y": 1480,
        "wires": []
    },
    {
        "id": "e4955c44e4805be0",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "f869eda640303ea9",
        "name": "calculate_cost",
        "func": "\nmsg.topic = `\nSELECT id, (start_charge - end_charge) AS total\nFROM chargerecords\nORDER BY id DESC\nLIMIT 1;\n`;\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 520,
        "y": 1480,
        "wires": [
            [
                "4a53b9a4fd55590d"
            ]
        ]
    },
    {
        "id": "4a53b9a4fd55590d",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "f869eda640303ea9",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 700,
        "y": 1480,
        "wires": [
            [
                "a496dfbf1a877790"
            ]
        ]
    },
    {
        "id": "a496dfbf1a877790",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "f869eda640303ea9",
        "name": "insert_transaction",
        "func": "let pv = {\n    electric: 0.6,\n    service: 0.3,\n    price_in_nok: 0.014\n};\n\nlet user_id = flow.get(\"u_id\");\n\n\nlet total_charged = msg.payload[0].total;\nlet completed_charge_transaction_id = msg.payload[0].id;\n\nflow.set(\"charge_record_id\",completed_charge_transaction_id);\n\n\nlet total_price =  total_charged * pv.electric * pv.price_in_nok;\n\n\nmsg.payload = [total_charged, user_id];\n\nmsg.topic = `\nINSERT INTO transactions (amount, user_id) VALUES (?, ?);\n`;\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 1440,
        "wires": [
            [
                "795507a12a4eb874"
            ]
        ]
    },
    {
        "id": "795507a12a4eb874",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "f869eda640303ea9",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 900,
        "y": 1480,
        "wires": [
            [
                "59b278d15e2d929b"
            ]
        ]
    },
    {
        "id": "59b278d15e2d929b",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "f869eda640303ea9",
        "name": "update_relations_table",
        "func": "let prev_record = msg.payload.insertId;\n\nlet cri = flow.get(\"charge_record_id\");\n\nmsg.payload = [prev_record, cri];\n\nmsg.topic = `\nUPDATE relations \nSET tr_id = ?\nWHERE\ncr_id = ?;\n`;\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 760,
        "y": 1560,
        "wires": [
            [
                "74c045ed69fa92a5"
            ]
        ]
    },
    {
        "id": "be19f84d4420d31b",
        "type": "debug",
        "z": "d974087eb4410441",
        "g": "f869eda640303ea9",
        "name": "debug 77",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1080,
        "y": 1560,
        "wires": []
    },
    {
        "id": "74c045ed69fa92a5",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "f869eda640303ea9",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 940,
        "y": 1560,
        "wires": [
            [
                "be19f84d4420d31b"
            ]
        ]
    },
    {
        "id": "1eb5338ba054f538",
        "type": "link in",
        "z": "d974087eb4410441",
        "g": "06136996c1318fcb",
        "name": "db.input.charge_station.input",
        "links": [
            "4f73999c3ec0b730"
        ],
        "x": 145,
        "y": 1680,
        "wires": [
            [
                "f389868ad80b10d3"
            ]
        ]
    },
    {
        "id": "f389868ad80b10d3",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "06136996c1318fcb",
        "name": "show_transactions",
        "func": "msg.topic = `\nSELECT t.id, c.parking_spot AS spot, cs.location , t.amount, t.user_id AS user  FROM transactions t \nLEFT JOIN relations r ON t.id = r.tr_id \nLEFT JOIN chargerecords c ON c.id = r.cr_id\nRIGHT JOIN chargestation cs ON cs.id = c.station_id; \n`;\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 340,
        "y": 1680,
        "wires": [
            [
                "f676c8b0e33e3933"
            ]
        ]
    },
    {
        "id": "f676c8b0e33e3933",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "06136996c1318fcb",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 550,
        "y": 1680,
        "wires": [
            [
                "94a3aa3a2d9fab70"
            ]
        ]
    },
    {
        "id": "94a3aa3a2d9fab70",
        "type": "link out",
        "z": "d974087eb4410441",
        "g": "06136996c1318fcb",
        "name": "db.output.charge_station.show_transactions",
        "mode": "link",
        "links": [
            "a2f162b9d394a186"
        ],
        "x": 695,
        "y": 1680,
        "wires": []
    },
    {
        "id": "ebb5eb51d6d86baa",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "24a0ae6f8db3a12a",
        "name": "show_transactions_toll_station",
        "func": "msg.topic = `\nSELECT t.id, ts.location, DATE_FORMAT(t.recorded_date, \"%T - %d.%m.%y\") AS recorded, t.amount, t.user_id AS userID  FROM transactions t \nLEFT JOIN relations r ON t.id = r.tr_id \nLEFT JOIN tollstation ts ON ts.id = r.toll_id\nWHERE ts.location IS NOT NULL; \n`;\n\nmsg.payload = \"test\";\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 980,
        "wires": [
            [
                "d5b6cd3abd938e5d"
            ]
        ]
    },
    {
        "id": "d5b6cd3abd938e5d",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "24a0ae6f8db3a12a",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 760,
        "y": 980,
        "wires": [
            [
                "753dc434ae2fe719"
            ]
        ]
    },
    {
        "id": "0a9dc2d0d62b6741",
        "type": "link in",
        "z": "d974087eb4410441",
        "g": "24a0ae6f8db3a12a",
        "name": "db.input.toll_transactions_new",
        "links": [
            "0ef456bd120be2eb",
            "32aa47b877961343"
        ],
        "x": 155,
        "y": 980,
        "wires": [
            [
                "ebb5eb51d6d86baa",
                "fff91732d0fa8eaa"
            ]
        ]
    },
    {
        "id": "753dc434ae2fe719",
        "type": "link out",
        "z": "d974087eb4410441",
        "g": "24a0ae6f8db3a12a",
        "name": "db.output.toll_station.return_transactions",
        "mode": "link",
        "links": [
            "13ca023302f0f7c1"
        ],
        "x": 945,
        "y": 980,
        "wires": []
    },
    {
        "id": "fff91732d0fa8eaa",
        "type": "debug",
        "z": "d974087eb4410441",
        "g": "24a0ae6f8db3a12a",
        "name": "debug 84",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 380,
        "y": 940,
        "wires": []
    },
    {
        "id": "be6997b1779be1cb",
        "type": "link in",
        "z": "d974087eb4410441",
        "g": "8a632c5013bf1898",
        "name": "db.input.from_transaction_requester_new",
        "links": [
            "0ff79d5862a3a192"
        ],
        "x": 155,
        "y": 780,
        "wires": [
            [
                "7d512223b414436e",
                "e3c1bd84176d0d68"
            ]
        ]
    },
    {
        "id": "7d512223b414436e",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "8a632c5013bf1898",
        "name": "insert_transaction",
        "func": "if (msg.topic === \"not_allowed\" || msg.payload === \"\") {\n    return null;\n} else {\n    let m = msg.payload;\n\n    msg.payload = [m.amount, m.user_id];\n    //INSERT INTO transactions(amount, user_id) VALUES(165, 1);\n\n    msg.topic = `\n    INSERT INTO transactions (amount, user_id) VALUES (?, ?);\n    `;\n}\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 780,
        "wires": [
            [
                "f703b09e8d73837c",
                "57b455cfb704e63e"
            ]
        ]
    },
    {
        "id": "f703b09e8d73837c",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "8a632c5013bf1898",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 530,
        "y": 780,
        "wires": [
            [
                "dcdd044879c73676",
                "3da54f0627ca6745"
            ]
        ]
    },
    {
        "id": "dcdd044879c73676",
        "type": "debug",
        "z": "d974087eb4410441",
        "g": "8a632c5013bf1898",
        "name": "debug 88",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 760,
        "wires": []
    },
    {
        "id": "3da54f0627ca6745",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "8a632c5013bf1898",
        "name": "update_relations_table",
        "func": "let prev_inserted = msg.payload.insertId;\nlet update_row = global.get(\"prev_inserted_toll_relations\")\n\nmsg.payload = [prev_inserted, update_row];\n\n\nmsg.topic = `\nUPDATE relations \nSET tr_id = ?\nWHERE\nid = ?;\n`\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 750,
        "y": 840,
        "wires": [
            [
                "499684e2335af520"
            ]
        ]
    },
    {
        "id": "fef5e4ca78ea74f7",
        "type": "function",
        "z": "d974087eb4410441",
        "g": "fa423b6c44026824",
        "name": "function 11",
        "func": "global.set(\"prev_inserted_toll_relations\", msg.payload.insertId);\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1110,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "499684e2335af520",
        "type": "mysql",
        "z": "d974087eb4410441",
        "g": "8a632c5013bf1898",
        "mydb": "f2952bbb2ad433e2",
        "name": "mdb-test",
        "x": 930,
        "y": 840,
        "wires": [
            [
                "f8943814e6c6be7b",
                "32aa47b877961343"
            ]
        ]
    },
    {
        "id": "f8943814e6c6be7b",
        "type": "debug",
        "z": "d974087eb4410441",
        "g": "8a632c5013bf1898",
        "name": "debug 89",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1090,
        "y": 840,
        "wires": []
    },
    {
        "id": "32aa47b877961343",
        "type": "link out",
        "z": "d974087eb4410441",
        "g": "8a632c5013bf1898",
        "name": "ping_transaction_request",
        "mode": "link",
        "links": [
            "0a9dc2d0d62b6741"
        ],
        "x": 1025,
        "y": 780,
        "wires": []
    },
    {
        "id": "e3c1bd84176d0d68",
        "type": "debug",
        "z": "d974087eb4410441",
        "g": "8a632c5013bf1898",
        "name": "debug 101",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 270,
        "y": 840,
        "wires": []
    },
    {
        "id": "57b455cfb704e63e",
        "type": "debug",
        "z": "d974087eb4410441",
        "g": "8a632c5013bf1898",
        "name": "debug 102",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 480,
        "y": 840,
        "wires": []
    },
    {
        "id": "ea5ff2cd0cdfe128",
        "type": "ui-template",
        "z": "9c23ead5f4cd17b6",
        "g": "1343424fbbdc4b4e",
        "group": "e6a3eaaef97c58a0",
        "page": "",
        "ui": "",
        "name": "display_users",
        "order": 3,
        "width": 0,
        "height": 0,
        "head": "",
        "format": "<template>\n    <v-text-field v-model=\"search\" label=\"Search\" prepend-inner-icon=\"mdi-magnify\" single-line variant=\"outlined\"\n    hide-details></v-text-field>\n    <v-data-table v-model:search=\"search\" :items=\"msg?.payload\">\n\n      <template v-slot:header.total_impact_score>\n        <div class=\"text-center\">Score</div>\n      </template>\n\n      <template v-slot:item.name=\"{ item }\">\n        {{ item.name }}\n      </template>\n\n      <template v-slot:item.score=\"{ item }\">\n        <v-progress-linear v-model=\"item.score\" min=\"0\" max=\"100\" height=\"25\" :color=\"getColor(item)\">\n          <template v-slot:default=\"{ value }\">\n            <strong>{{ Math.round(item.score * 100) / 100 }}</strong>\n          </template>\n        </v-progress-linear>\n      </template>\n\n    </v-data-table>\n</template>\n\n<script>\n    export default {\n    data () {\n      return {\n        search: ''\n      }\n    },\n    methods: {\n      getColor: function (item) {\n        if (item.score < 70) {\n          return 'red'\n        } else {\n          return 'green'\n        }\n      }\n    }\n  }\n</script>",
        "storeOutMessages": true,
        "passthru": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 580,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "dc1d7aadb5cf6f36",
        "type": "ui-template",
        "z": "9c23ead5f4cd17b6",
        "g": "0591b57e8f20d00d",
        "group": "",
        "page": "",
        "ui": "ed3a4854fa1b4db8",
        "name": "css_all_pages",
        "order": 0,
        "width": 0,
        "height": 0,
        "head": "",
        "format": "\n\nbody {\n    font-family: monospace;\n}\n\n\n.v-main {\n    background-image: url(\"\thttps://www.transparenttextures.com/patterns/batthern.png\");\n    background-repeat: repeat;\n}\n\n",
        "storeOutMessages": true,
        "passthru": true,
        "resendOnRefresh": true,
        "templateScope": "site:style",
        "className": "",
        "x": 160,
        "y": 60,
        "wires": [
            [
                "b23d2583cd712fdc"
            ]
        ]
    },
    {
        "id": "723dda3faa263f6c",
        "type": "function",
        "z": "9c23ead5f4cd17b6",
        "g": "1343424fbbdc4b4e",
        "name": "function 4",
        "func": "//if (msg.payload == \"Loaded\") {\n//    msg.payload = [{ \"room\": \"Living Room\", \"id\": \"1234\", \"target\": 18.1, \"current\": 20 }, { \"room\": \"Bathroom Room\", \"id\": \"5678\", \"target\": 19.5, \"current\": 18 }, { \"room\": \"Kitchen Room\", \"id\": \"9101\", \"target\": 18.1, \"current\": 17.6 }]\n//    msg.topic = \"input\"\n//} else {\n//    msg.payload = \"in home folder\"\n//    msg.topic = \"input\"\n//}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 240,
        "wires": [
            [
                "070400a13d344993",
                "ea5ff2cd0cdfe128"
            ]
        ]
    },
    {
        "id": "070400a13d344993",
        "type": "debug",
        "z": "9c23ead5f4cd17b6",
        "g": "1343424fbbdc4b4e",
        "name": "debug 24",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 560,
        "y": 240,
        "wires": []
    },
    {
        "id": "ec77049af9dae0ab",
        "type": "ui-control",
        "z": "9c23ead5f4cd17b6",
        "name": "",
        "ui": "ed3a4854fa1b4db8",
        "events": "all",
        "x": 1140,
        "y": 160,
        "wires": [
            [
                "1bf8e1c16c995ae6"
            ]
        ]
    },
    {
        "id": "1bf8e1c16c995ae6",
        "type": "debug",
        "z": "9c23ead5f4cd17b6",
        "name": "debug 27",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1300,
        "y": 160,
        "wires": []
    },
    {
        "id": "c1964b765cb6e87e",
        "type": "inject",
        "z": "9c23ead5f4cd17b6",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Contact",
        "payloadType": "str",
        "x": 930,
        "y": 160,
        "wires": [
            [
                "ec77049af9dae0ab"
            ]
        ]
    },
    {
        "id": "a71d16685af96a6c",
        "type": "ui-button",
        "z": "9c23ead5f4cd17b6",
        "group": "78b509623ddc3923",
        "name": "button.contact",
        "label": "Contact button",
        "order": 0,
        "width": 0,
        "height": 0,
        "emulateClick": false,
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "iconPosition": "left",
        "payload": "Contact",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 900,
        "y": 220,
        "wires": [
            [
                "ec77049af9dae0ab"
            ]
        ]
    },
    {
        "id": "856de6d3ce3eff89",
        "type": "ui-template",
        "z": "9c23ead5f4cd17b6",
        "g": "1343424fbbdc4b4e",
        "group": "e6a3eaaef97c58a0",
        "page": "",
        "ui": "",
        "name": "users.pageload",
        "order": 1,
        "width": 0,
        "height": 0,
        "head": "",
        "format": "<script>\n    export default {\n    data () {\n\n    },\n    methods: {\n    },\n    mounted() {\n      this.loaded = true\n      this.send(\"Loaded\")\n    },\n    unmounted() {\n      this.loaded = false\n    }\n  }\n</script>",
        "storeOutMessages": true,
        "passthru": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 160,
        "y": 160,
        "wires": [
            [
                "f088635e3f42d421",
                "efe612ce80eab15c"
            ]
        ]
    },
    {
        "id": "f088635e3f42d421",
        "type": "link out",
        "z": "9c23ead5f4cd17b6",
        "g": "1343424fbbdc4b4e",
        "name": "dashbaord.output.getusers",
        "mode": "link",
        "links": [
            "2bd950a05a93757a"
        ],
        "x": 315,
        "y": 160,
        "wires": []
    },
    {
        "id": "33998569dd15990e",
        "type": "link in",
        "z": "9c23ead5f4cd17b6",
        "g": "1343424fbbdc4b4e",
        "name": "dashboard.input.getusers",
        "links": [
            "a5837349ffd6fca1"
        ],
        "x": 95,
        "y": 240,
        "wires": [
            [
                "723dda3faa263f6c"
            ]
        ]
    },
    {
        "id": "29614505de526e3e",
        "type": "ui-template",
        "z": "9c23ead5f4cd17b6",
        "group": "d68e6862685d10df",
        "page": "",
        "ui": "",
        "name": "star_rating",
        "order": 4,
        "width": 0,
        "height": 0,
        "head": "",
        "format": "<template>\n  <div class=\"text-center\">\n    <v-rating\n      hover :length=\"5\" :size=\"32\"\n      v-model=\"value\"\n      active-color=\"primary\"\n      @update:model-value=\"send({payload: value})\"\n    ></v-rating>\n  </div>\n</template>",
        "storeOutMessages": true,
        "passthru": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 890,
        "y": 80,
        "wires": [
            [
                "7bb2d1e517ee8d24"
            ]
        ]
    },
    {
        "id": "7bb2d1e517ee8d24",
        "type": "debug",
        "z": "9c23ead5f4cd17b6",
        "name": "debugstar",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1130,
        "y": 80,
        "wires": []
    },
    {
        "id": "728bcfee316180c5",
        "type": "ui-text-input",
        "z": "9c23ead5f4cd17b6",
        "g": "116ddb3989f7865c",
        "group": "f4b408f314ea8fb3",
        "name": "electric_car",
        "label": "Electric",
        "order": 4,
        "width": "1",
        "height": "1",
        "topic": "topic",
        "topicType": "msg",
        "mode": "number",
        "delay": 300,
        "passthru": true,
        "sendOnDelay": false,
        "sendOnBlur": true,
        "sendOnEnter": true,
        "className": "",
        "x": 670,
        "y": 720,
        "wires": [
            [
                "d3bb702bcdf691a1"
            ]
        ]
    },
    {
        "id": "9695c47a09c4d657",
        "type": "function",
        "z": "9c23ead5f4cd17b6",
        "g": "116ddb3989f7865c",
        "name": "prices",
        "func": "\n\nlet e_price = global.get(\"toll_electric\");\nlet s_price = global.get(\"toll_service\");\nlet g_price = global.get(\"toll_gasoline\");\n\n\nlet s = 5;\nlet g = 25;\n\n\nlet current_prices = {\n    electric: e_price,\n    service: s_price,\n    gasoline: g_price\n};\n\nmsg.payload = current_prices;\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 230,
        "y": 760,
        "wires": [
            [
                "d5bb29401cd9c2f9"
            ]
        ]
    },
    {
        "id": "04613cd67e7bd8bd",
        "type": "ui-template",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "group": "f4b408f314ea8fb3",
        "page": "",
        "ui": "",
        "name": "tollstation.pageload",
        "order": 1,
        "width": 0,
        "height": 0,
        "head": "",
        "format": "\n<script>\n    export default {\n    data () {\n    },\n    methods: {\n    },\n    mounted() {\n      this.loaded = true\n      this.send(\"Loaded\")\n    },\n    unmounted() {\n      this.loaded = false\n    }\n  }\n</script>",
        "storeOutMessages": true,
        "passthru": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 210,
        "y": 420,
        "wires": [
            [
                "6f2b6412d3243be9",
                "da204c00005594c9",
                "0ef456bd120be2eb",
                "1d92a8088d77f436"
            ]
        ]
    },
    {
        "id": "fd21801d95c179a1",
        "type": "ui-text-input",
        "z": "9c23ead5f4cd17b6",
        "g": "116ddb3989f7865c",
        "group": "f4b408f314ea8fb3",
        "name": "service_car",
        "label": "Service",
        "order": 5,
        "width": "1",
        "height": "1",
        "topic": "topic",
        "topicType": "msg",
        "mode": "number",
        "delay": 300,
        "passthru": true,
        "sendOnDelay": false,
        "sendOnBlur": true,
        "sendOnEnter": true,
        "className": "",
        "x": 670,
        "y": 760,
        "wires": [
            [
                "d3bb702bcdf691a1"
            ]
        ]
    },
    {
        "id": "6a8d7251a99d269b",
        "type": "ui-text-input",
        "z": "9c23ead5f4cd17b6",
        "g": "116ddb3989f7865c",
        "group": "f4b408f314ea8fb3",
        "name": "gasoline_car",
        "label": "Gasoline",
        "order": 6,
        "width": "1",
        "height": "1",
        "topic": "topic",
        "topicType": "msg",
        "mode": "number",
        "delay": 300,
        "passthru": true,
        "sendOnDelay": false,
        "sendOnBlur": true,
        "sendOnEnter": true,
        "className": "",
        "x": 670,
        "y": 800,
        "wires": [
            [
                "d3bb702bcdf691a1"
            ]
        ]
    },
    {
        "id": "49ab5c9eef18e2fe",
        "type": "debug",
        "z": "9c23ead5f4cd17b6",
        "g": "116ddb3989f7865c",
        "name": "debug 47",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1040,
        "y": 760,
        "wires": []
    },
    {
        "id": "d3bb702bcdf691a1",
        "type": "function",
        "z": "9c23ead5f4cd17b6",
        "g": "116ddb3989f7865c",
        "name": "update_service",
        "func": "if (msg.parts.key == \"electric\"){\n    //global.set(\"toll_electric\", msg.payload);\n    msg.payload = msg.payload;\n}\n\n\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 880,
        "y": 760,
        "wires": [
            [
                "49ab5c9eef18e2fe"
            ]
        ]
    },
    {
        "id": "2636e9073bae688d",
        "type": "switch",
        "z": "9c23ead5f4cd17b6",
        "g": "116ddb3989f7865c",
        "name": "",
        "property": "parts.key",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "electric",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "service",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "gasoline",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 490,
        "y": 820,
        "wires": [
            [
                "728bcfee316180c5"
            ],
            [
                "fd21801d95c179a1"
            ],
            [
                "6a8d7251a99d269b"
            ]
        ]
    },
    {
        "id": "d5bb29401cd9c2f9",
        "type": "split",
        "z": "9c23ead5f4cd17b6",
        "g": "116ddb3989f7865c",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 370,
        "y": 760,
        "wires": [
            [
                "2636e9073bae688d"
            ]
        ]
    },
    {
        "id": "d2c115aaae325b40",
        "type": "comment",
        "z": "9c23ead5f4cd17b6",
        "g": "116ddb3989f7865c",
        "name": "make db-implementation",
        "info": "",
        "x": 950,
        "y": 840,
        "wires": []
    },
    {
        "id": "b23d2583cd712fdc",
        "type": "debug",
        "z": "9c23ead5f4cd17b6",
        "g": "0591b57e8f20d00d",
        "name": "debug 48",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 360,
        "y": 60,
        "wires": []
    },
    {
        "id": "d9f5b4ebe6ceadec",
        "type": "link out",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "name": "dashboard.output.refresh_true",
        "mode": "link",
        "links": [
            "e1c49e9771213b10"
        ],
        "x": 835,
        "y": 480,
        "wires": []
    },
    {
        "id": "ddefcb191dc9d43a",
        "type": "link in",
        "z": "9c23ead5f4cd17b6",
        "g": "116ddb3989f7865c",
        "name": "dashboard.input.update_prices",
        "links": [
            "438180f8e7ed266d",
            "7d834a69f9cfe8eb"
        ],
        "x": 115,
        "y": 760,
        "wires": [
            [
                "9695c47a09c4d657"
            ]
        ]
    },
    {
        "id": "6f2b6412d3243be9",
        "type": "function",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "name": "decide_if_refresh",
        "func": "let action = false;\n\nif (!global.get(\"toll_electric\") || !global.get(\"toll_gasoline\") || !global.get(\"toll_service\")) {\n    action = true;\n}\n\nmsg.payload = action;\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 540,
        "wires": [
            [
                "32bba6d6bdb66cee"
            ]
        ]
    },
    {
        "id": "32bba6d6bdb66cee",
        "type": "switch",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 650,
        "y": 540,
        "wires": [
            [
                "d9f5b4ebe6ceadec"
            ],
            [
                "7d834a69f9cfe8eb"
            ]
        ]
    },
    {
        "id": "7d834a69f9cfe8eb",
        "type": "link out",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "name": "dashboard.output.refresh_false",
        "mode": "link",
        "links": [
            "ddefcb191dc9d43a"
        ],
        "x": 835,
        "y": 560,
        "wires": []
    },
    {
        "id": "da204c00005594c9",
        "type": "function",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "name": "function 5",
        "func": "let a = global.get(\"toll_electric\");\n\nmsg.payload = a;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 440,
        "y": 580,
        "wires": [
            [
                "38573d34b841eb61"
            ]
        ]
    },
    {
        "id": "38573d34b841eb61",
        "type": "debug",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "name": "debug 51",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 580,
        "wires": []
    },
    {
        "id": "9ae509c0229a4605",
        "type": "ui-text",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "group": "f4b408f314ea8fb3",
        "order": 2,
        "width": "2",
        "height": "1",
        "name": "",
        "label": "Selected station",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "style": true,
        "font": "Helvetica, sans-serif",
        "fontSize": 16,
        "color": "#1c1c1c",
        "className": "",
        "x": 800,
        "y": 380,
        "wires": []
    },
    {
        "id": "9dca2e760e12e3df",
        "type": "ui-text-input",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "group": "f4b408f314ea8fb3",
        "name": "input_station",
        "label": "station_id",
        "order": 3,
        "width": "1",
        "height": "1",
        "topic": "topic",
        "topicType": "msg",
        "mode": "number",
        "delay": 300,
        "passthru": true,
        "sendOnDelay": false,
        "sendOnBlur": true,
        "sendOnEnter": true,
        "className": "",
        "x": 790,
        "y": 420,
        "wires": [
            [
                "ef9316e3662e77af"
            ]
        ]
    },
    {
        "id": "ef9316e3662e77af",
        "type": "function",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "name": "clamp",
        "func": "if (msg.payload <= 1) {\n    msg.payload = 1;\n}\n\n\n\n\nglobal.set(\"selected_toll_station\", msg.payload);\n\nmsg.topic = \"request_from_toll_prices\"\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 950,
        "y": 420,
        "wires": [
            [
                "d9f5b4ebe6ceadec",
                "f66c10cd59cbac6e"
            ]
        ]
    },
    {
        "id": "b3df72d8dcb2bc3a",
        "type": "link in",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "name": "link in 12",
        "links": [
            "f82bd2713bd5bea4"
        ],
        "x": 515,
        "y": 500,
        "wires": [
            [
                "2d68d6a1aa9ef244"
            ]
        ]
    },
    {
        "id": "2d68d6a1aa9ef244",
        "type": "switch",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "id_error",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "ok",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 650,
        "y": 500,
        "wires": [
            [
                "9ae509c0229a4605"
            ],
            [
                "2848dc9c2586b927",
                "438180f8e7ed266d",
                "9ae509c0229a4605"
            ]
        ]
    },
    {
        "id": "2848dc9c2586b927",
        "type": "debug",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "name": "debug 55",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 600,
        "y": 440,
        "wires": []
    },
    {
        "id": "438180f8e7ed266d",
        "type": "link out",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "name": "communication.output.refresh_after_change",
        "mode": "link",
        "links": [
            "ddefcb191dc9d43a"
        ],
        "x": 835,
        "y": 520,
        "wires": []
    },
    {
        "id": "d02bfa02ad7249ef",
        "type": "ui-template",
        "z": "9c23ead5f4cd17b6",
        "g": "716618853d781b35",
        "group": "6294bb50f136aac5",
        "page": "",
        "ui": "",
        "name": "chargestation.pageload",
        "order": 1,
        "width": 0,
        "height": 0,
        "head": "",
        "format": "\n<script>\n    export default {\n    data () {\n    },\n    methods: {\n    },\n    mounted() {\n      this.loaded = true\n      this.send(\"Loaded\")\n    },\n    unmounted() {\n      this.loaded = false\n    }\n  }\n</script>",
        "storeOutMessages": true,
        "passthru": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 190,
        "y": 1360,
        "wires": [
            [
                "4f73999c3ec0b730"
            ]
        ]
    },
    {
        "id": "02ae78a50512873e",
        "type": "link in",
        "z": "9c23ead5f4cd17b6",
        "g": "716618853d781b35",
        "name": "link in 15",
        "links": [
            "d37374ec32398ba1"
        ],
        "x": 115,
        "y": 1660,
        "wires": [
            [
                "851722563ece208c"
            ]
        ]
    },
    {
        "id": "851722563ece208c",
        "type": "ui-text",
        "z": "9c23ead5f4cd17b6",
        "g": "716618853d781b35",
        "group": "6294bb50f136aac5",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "weather_info",
        "label": "text",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "className": "",
        "x": 570,
        "y": 1660,
        "wires": []
    },
    {
        "id": "4f73999c3ec0b730",
        "type": "link out",
        "z": "9c23ead5f4cd17b6",
        "g": "716618853d781b35",
        "name": "ui.output.pageload.charge_station",
        "mode": "link",
        "links": [
            "1eb5338ba054f538"
        ],
        "x": 375,
        "y": 1360,
        "wires": []
    },
    {
        "id": "8c702c77dd36bdca",
        "type": "ui-template",
        "z": "9c23ead5f4cd17b6",
        "g": "716618853d781b35",
        "group": "31182dd191e0795c",
        "page": "",
        "ui": "",
        "name": "Display charge transactions",
        "order": 3,
        "width": 0,
        "height": 0,
        "head": "",
        "format": "<template>\n    <v-text-field v-model=\"search\" label=\"Search\" prepend-inner-icon=\"mdi-magnify\" single-line variant=\"outlined\"\n    hide-details></v-text-field>\n    <v-data-table v-model:search=\"search\" :items=\"msg?.payload\">\n    </v-data-table>\n</template>\n\n<script>\n    export default {\n    data () {\n      return {\n        search: ''\n      }\n    },\n    methods: {\n    }\n  }\n</script>",
        "storeOutMessages": true,
        "passthru": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 520,
        "y": 1520,
        "wires": [
            []
        ]
    },
    {
        "id": "a2f162b9d394a186",
        "type": "link in",
        "z": "9c23ead5f4cd17b6",
        "g": "716618853d781b35",
        "name": "dashboard.input.charge_station.show_transactions",
        "links": [
            "94a3aa3a2d9fab70"
        ],
        "x": 105,
        "y": 1520,
        "wires": [
            [
                "8c702c77dd36bdca",
                "5763ca455449785b"
            ]
        ]
    },
    {
        "id": "5763ca455449785b",
        "type": "debug",
        "z": "9c23ead5f4cd17b6",
        "g": "716618853d781b35",
        "name": "debug 78",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 560,
        "y": 1580,
        "wires": []
    },
    {
        "id": "f66c10cd59cbac6e",
        "type": "debug",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "name": "debug 79",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1060,
        "y": 380,
        "wires": []
    },
    {
        "id": "534a1b47f4d8f647",
        "type": "link in",
        "z": "9c23ead5f4cd17b6",
        "g": "716618853d781b35",
        "name": "link in 16",
        "links": [
            "20e026677c68bd7b"
        ],
        "x": 115,
        "y": 1760,
        "wires": [
            [
                "98166c48d39ce2bd"
            ]
        ]
    },
    {
        "id": "98166c48d39ce2bd",
        "type": "switch",
        "z": "9c23ead5f4cd17b6",
        "g": "716618853d781b35",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "esp32/led/value1",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "esp32/led/value2",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "esp32/led/value3",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 250,
        "y": 1760,
        "wires": [
            [
                "5c642316acf14a1a"
            ],
            [
                "28982104b2fdba96"
            ],
            [
                "3e228f6c26bdbf05"
            ]
        ]
    },
    {
        "id": "5c642316acf14a1a",
        "type": "function",
        "z": "9c23ead5f4cd17b6",
        "g": "716618853d781b35",
        "name": "function 10",
        "func": "\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 1720,
        "wires": [
            [
                "df1a6337d2b7930f"
            ]
        ]
    },
    {
        "id": "df1a6337d2b7930f",
        "type": "ui-text",
        "z": "9c23ead5f4cd17b6",
        "g": "716618853d781b35",
        "group": "6294bb50f136aac5",
        "order": 0,
        "width": "2",
        "height": "1",
        "name": "spot_1",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "row-right",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "className": "",
        "x": 590,
        "y": 1720,
        "wires": []
    },
    {
        "id": "28982104b2fdba96",
        "type": "ui-text",
        "z": "9c23ead5f4cd17b6",
        "g": "716618853d781b35",
        "group": "6294bb50f136aac5",
        "order": 0,
        "width": "2",
        "height": "1",
        "name": "spot_2",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "className": "",
        "x": 590,
        "y": 1780,
        "wires": []
    },
    {
        "id": "3e228f6c26bdbf05",
        "type": "ui-text",
        "z": "9c23ead5f4cd17b6",
        "g": "716618853d781b35",
        "group": "e6a3eaaef97c58a0",
        "order": 0,
        "width": "2",
        "height": "1",
        "name": "spot_3",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "className": "",
        "x": 590,
        "y": 1840,
        "wires": []
    },
    {
        "id": "5d464c9e479cc761",
        "type": "ui-template",
        "z": "9c23ead5f4cd17b6",
        "g": "1d2d15338a8c5623",
        "group": "b2e2400c7d47390e",
        "page": "",
        "ui": "",
        "name": "display_toll_transactions",
        "order": 3,
        "width": 0,
        "height": 0,
        "head": "",
        "format": "<template>\n    <v-text-field v-model=\"search\" label=\"Search\" prepend-inner-icon=\"mdi-magnify\" single-line variant=\"outlined\"\n    hide-details></v-text-field>\n    \n    <v-data-table v-model:search=\"search\" :items=\"msg?.payload\">\n    </v-data-table>\n</template>\n\n<script>\n    export default {\n    data () {\n      return {\n        search: ''\n      }\n    },\n    methods: {\n    }\n  }\n</script>",
        "storeOutMessages": true,
        "passthru": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 510,
        "y": 1120,
        "wires": [
            []
        ]
    },
    {
        "id": "0ef456bd120be2eb",
        "type": "link out",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "name": "ui.output.pageload_toll_station",
        "mode": "link",
        "links": [
            "0a9dc2d0d62b6741"
        ],
        "x": 385,
        "y": 420,
        "wires": []
    },
    {
        "id": "13ca023302f0f7c1",
        "type": "link in",
        "z": "9c23ead5f4cd17b6",
        "g": "1d2d15338a8c5623",
        "name": "ui.input.toll.get_all_transactions",
        "links": [
            "753dc434ae2fe719"
        ],
        "x": 125,
        "y": 1120,
        "wires": [
            [
                "5d464c9e479cc761",
                "972d5d3d6cd4f34a"
            ]
        ]
    },
    {
        "id": "1d92a8088d77f436",
        "type": "debug",
        "z": "9c23ead5f4cd17b6",
        "g": "69f933624170a8db",
        "name": "debug 85",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 440,
        "y": 380,
        "wires": []
    },
    {
        "id": "efe612ce80eab15c",
        "type": "debug",
        "z": "9c23ead5f4cd17b6",
        "g": "1343424fbbdc4b4e",
        "name": "debug 86",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 320,
        "y": 200,
        "wires": []
    },
    {
        "id": "972d5d3d6cd4f34a",
        "type": "debug",
        "z": "9c23ead5f4cd17b6",
        "g": "1d2d15338a8c5623",
        "name": "debug 87",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 560,
        "y": 1180,
        "wires": []
    },
    {
        "id": "caea40b5a9e7fce1",
        "type": "ui-text",
        "z": "9c23ead5f4cd17b6",
        "g": "074b02fb1e104e89",
        "group": "d6abd85606225eb0",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "statusmessage",
        "label": "Message:",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "style": false,
        "font": "Impact,Impact,Charcoal,sans-serif",
        "fontSize": 16,
        "color": "#b8393b",
        "className": "",
        "x": 620,
        "y": 1000,
        "wires": []
    },
    {
        "id": "c7142d427ef14ae9",
        "type": "link in",
        "z": "9c23ead5f4cd17b6",
        "g": "074b02fb1e104e89",
        "name": "ui.input.show_message",
        "links": [
            "2fdb2fe082259b37"
        ],
        "x": 125,
        "y": 1000,
        "wires": [
            [
                "2aef9186218d7693"
            ]
        ]
    },
    {
        "id": "2aef9186218d7693",
        "type": "function",
        "z": "9c23ead5f4cd17b6",
        "g": "074b02fb1e104e89",
        "name": "display_message",
        "func": "if (msg.topic === \"not_allowed\") {\n    msg.payload = \"Current vehicle not allowed through toll station.\"\n} else if (msg.topic == \"restart\") {\n    msg.payload = \"All Ok.\"\n} else {\n    msg.payload = \"All Ok.\"\n}\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 370,
        "y": 1000,
        "wires": [
            [
                "caea40b5a9e7fce1"
            ]
        ]
    },
    {
        "id": "84adb6cc5526036c",
        "type": "inject",
        "z": "9c23ead5f4cd17b6",
        "g": "074b02fb1e104e89",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "all ok",
        "payloadType": "str",
        "x": 220,
        "y": 960,
        "wires": [
            [
                "2aef9186218d7693"
            ]
        ]
    }
]